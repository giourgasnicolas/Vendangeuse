#
#	MBsysTran - Release 8.1
#
#	Copyright 
#	Universite catholique de Louvain (UCLouvain) 
#	Mechatronic, Electrical Energy, and Dynamic systems (MEED Division) 
#	2, Place du Levant
#	1348 Louvain-la-Neuve 
#	Belgium 
#
#	http://www.robotran.be 
#
#	==> Generation Date: Wed May  4 23:04:45 2022
#
#	==> Project name: waoo
#
#	==> Number of joints: 33
#
#	==> Function: F19 - External Forces
#
#	==> Git hash: 220d76a94da8547597795a13c9921f0375de3fc1
#

from math import sin, cos, sqrt
from numpy import zeros

def extforces(frc, trq, s, tsim):
    q = s.q
    qd = s.qd
    qdd = s.qdd
    frc = s.frc
    trq = s.trq
    PxF1 = zeros(4)
    RxF1 = zeros((4, 4))
    VxF1 = zeros(4)
    OMxF1 = zeros(4)
    AxF1 = zeros(4)
    OMPxF1 = zeros(4)

    PxF2 = zeros(4)
    RxF2 = zeros((4, 4))
    VxF2 = zeros(4)
    OMxF2 = zeros(4)
    AxF2 = zeros(4)
    OMPxF2 = zeros(4)

    PxF3 = zeros(4)
    RxF3 = zeros((4, 4))
    VxF3 = zeros(4)
    OMxF3 = zeros(4)
    AxF3 = zeros(4)
    OMPxF3 = zeros(4)

    PxF4 = zeros(4)
    RxF4 = zeros((4, 4))
    VxF4 = zeros(4)
    OMxF4 = zeros(4)
    AxF4 = zeros(4)
    OMPxF4 = zeros(4)

 
# Trigonometric functions

    S4 = sin(q[4])
    C4 = cos(q[4])
    S5 = sin(q[5])
    C5 = cos(q[5])
    S6 = sin(q[6])
    C6 = cos(q[6])
    S7 = sin(q[7])
    C7 = cos(q[7])
    S8 = sin(q[8])
    C8 = cos(q[8])
    S9 = sin(q[9])
    C9 = cos(q[9])
    S12 = sin(q[12])
    C12 = cos(q[12])
    S13 = sin(q[13])
    C13 = cos(q[13])
    S14 = sin(q[14])
    C14 = cos(q[14])
    S15 = sin(q[15])
    C15 = cos(q[15])
    S18 = sin(q[18])
    C18 = cos(q[18])
    S19 = sin(q[19])
    C19 = cos(q[19])
    S20 = sin(q[20])
    C20 = cos(q[20])
    S21 = sin(q[21])
    C21 = cos(q[21])
    S22 = sin(q[22])
    C22 = cos(q[22])
    S25 = sin(q[25])
    C25 = cos(q[25])
    S26 = sin(q[26])
    C26 = cos(q[26])
    S27 = sin(q[27])
    C27 = cos(q[27])
    S28 = sin(q[28])
    C28 = cos(q[28])
    S31 = sin(q[31])
    C31 = cos(q[31])
    S32 = sin(q[32])
    C32 = cos(q[32])
 
# Augmented Joint Position Vectors

    Dz113 = q[11]+s.dpt[3,6]
    Dz173 = q[17]+s.dpt[3,9]
    Dz243 = q[24]+s.dpt[3,11]
    Dz303 = q[30]+s.dpt[3,14]
 
# Augmented Joint Position Vectors

 
# Sensor Kinematics

    ROcp2_45 = -S4*C5
    ROcp2_55 = C4*C5
    ROcp2_75 = S4*S5
    ROcp2_85 = -C4*S5
    ROcp2_16 = -ROcp2_75*S6+C4*C6
    ROcp2_26 = -ROcp2_85*S6+S4*C6
    ROcp2_36 = -C5*S6
    ROcp2_76 = ROcp2_75*C6+C4*S6
    ROcp2_86 = ROcp2_85*C6+S4*S6
    ROcp2_96 = C5*C6
    ROcp2_47 = ROcp2_45*C7+ROcp2_76*S7
    ROcp2_57 = ROcp2_55*C7+ROcp2_86*S7
    ROcp2_67 = ROcp2_96*S7+S5*C7
    ROcp2_77 = -ROcp2_45*S7+ROcp2_76*C7
    ROcp2_87 = -ROcp2_55*S7+ROcp2_86*C7
    ROcp2_97 = ROcp2_96*C7-S5*S7
    ROcp2_18 = ROcp2_16*C8-ROcp2_77*S8
    ROcp2_28 = ROcp2_26*C8-ROcp2_87*S8
    ROcp2_38 = ROcp2_36*C8-ROcp2_97*S8
    ROcp2_78 = ROcp2_16*S8+ROcp2_77*C8
    ROcp2_88 = ROcp2_26*S8+ROcp2_87*C8
    ROcp2_98 = ROcp2_36*S8+ROcp2_97*C8
    ROcp2_19 = ROcp2_18*C9+ROcp2_47*S9
    ROcp2_29 = ROcp2_28*C9+ROcp2_57*S9
    ROcp2_39 = ROcp2_38*C9+ROcp2_67*S9
    ROcp2_49 = -ROcp2_18*S9+ROcp2_47*C9
    ROcp2_59 = -ROcp2_28*S9+ROcp2_57*C9
    ROcp2_69 = -ROcp2_38*S9+ROcp2_67*C9
    ROcp2_412 = ROcp2_49*C12+ROcp2_78*S12
    ROcp2_512 = ROcp2_59*C12+ROcp2_88*S12
    ROcp2_612 = ROcp2_69*C12+ROcp2_98*S12
    ROcp2_712 = -ROcp2_49*S12+ROcp2_78*C12
    ROcp2_812 = -ROcp2_59*S12+ROcp2_88*C12
    ROcp2_912 = -ROcp2_69*S12+ROcp2_98*C12
    ROcp2_113 = ROcp2_19*C13-ROcp2_712*S13
    ROcp2_213 = ROcp2_29*C13-ROcp2_812*S13
    ROcp2_313 = ROcp2_39*C13-ROcp2_912*S13
    ROcp2_713 = ROcp2_19*S13+ROcp2_712*C13
    ROcp2_813 = ROcp2_29*S13+ROcp2_812*C13
    ROcp2_913 = ROcp2_39*S13+ROcp2_912*C13
    OMcp2_15 = qd[5]*C4
    OMcp2_25 = qd[5]*S4
    OPcp2_15 = -qd[4]*qd[5]*S4+qdd[5]*C4
    OPcp2_25 = qd[4]*qd[5]*C4+qdd[5]*S4
    OMcp2_16 = OMcp2_15+qd[6]*ROcp2_45
    OMcp2_26 = OMcp2_25+qd[6]*ROcp2_55
    OMcp2_36 = qd[4]+qd[6]*S5
    OPcp2_16 = OPcp2_15+qd[6]*(-qd[4]*ROcp2_55+OMcp2_25*S5)+qdd[6]*ROcp2_45
    OPcp2_26 = OPcp2_25+qd[6]*(qd[4]*ROcp2_45-OMcp2_15*S5)+qdd[6]*ROcp2_55
    OPcp2_36 = qdd[4]+qd[6]*(OMcp2_15*ROcp2_55-OMcp2_25*ROcp2_45)+qdd[6]*S5
    RLcp2_17 = ROcp2_16*s.dpt[1,1]+ROcp2_45*s.dpt[2,1]+ROcp2_76*s.dpt[3,1]
    RLcp2_27 = ROcp2_26*s.dpt[1,1]+ROcp2_55*s.dpt[2,1]+ROcp2_86*s.dpt[3,1]
    RLcp2_37 = ROcp2_36*s.dpt[1,1]+ROcp2_96*s.dpt[3,1]+s.dpt[2,1]*S5
    POcp2_17 = q[1]+RLcp2_17
    POcp2_27 = q[2]+RLcp2_27
    POcp2_37 = q[3]+RLcp2_37
    OMcp2_17 = OMcp2_16+qd[7]*ROcp2_16
    OMcp2_27 = OMcp2_26+qd[7]*ROcp2_26
    OMcp2_37 = OMcp2_36+qd[7]*ROcp2_36
    ORcp2_17 = OMcp2_26*RLcp2_37-OMcp2_36*RLcp2_27
    ORcp2_27 = -OMcp2_16*RLcp2_37+OMcp2_36*RLcp2_17
    ORcp2_37 = OMcp2_16*RLcp2_27-OMcp2_26*RLcp2_17
    VIcp2_17 = qd[1]+ORcp2_17
    VIcp2_27 = qd[2]+ORcp2_27
    VIcp2_37 = qd[3]+ORcp2_37
    OPcp2_17 = OPcp2_16+qd[7]*(OMcp2_26*ROcp2_36-OMcp2_36*ROcp2_26)+qdd[7]*ROcp2_16
    OPcp2_27 = OPcp2_26+qd[7]*(-OMcp2_16*ROcp2_36+OMcp2_36*ROcp2_16)+qdd[7]*ROcp2_26
    OPcp2_37 = OPcp2_36+qd[7]*(OMcp2_16*ROcp2_26-OMcp2_26*ROcp2_16)+qdd[7]*ROcp2_36
    ACcp2_17 = qdd[1]+OMcp2_26*ORcp2_37-OMcp2_36*ORcp2_27+OPcp2_26*RLcp2_37-OPcp2_36*RLcp2_27
    ACcp2_27 = qdd[2]-OMcp2_16*ORcp2_37+OMcp2_36*ORcp2_17-OPcp2_16*RLcp2_37+OPcp2_36*RLcp2_17
    ACcp2_37 = qdd[3]+OMcp2_16*ORcp2_27-OMcp2_26*ORcp2_17+OPcp2_16*RLcp2_27-OPcp2_26*RLcp2_17
    OMcp2_18 = OMcp2_17+qd[8]*ROcp2_47
    OMcp2_28 = OMcp2_27+qd[8]*ROcp2_57
    OMcp2_38 = OMcp2_37+qd[8]*ROcp2_67
    OPcp2_18 = OPcp2_17+qd[8]*(OMcp2_27*ROcp2_67-OMcp2_37*ROcp2_57)+qdd[8]*ROcp2_47
    OPcp2_28 = OPcp2_27+qd[8]*(-OMcp2_17*ROcp2_67+OMcp2_37*ROcp2_47)+qdd[8]*ROcp2_57
    OPcp2_38 = OPcp2_37+qd[8]*(OMcp2_17*ROcp2_57-OMcp2_27*ROcp2_47)+qdd[8]*ROcp2_67
    OMcp2_19 = OMcp2_18+qd[9]*ROcp2_78
    OMcp2_29 = OMcp2_28+qd[9]*ROcp2_88
    OMcp2_39 = OMcp2_38+qd[9]*ROcp2_98
    OPcp2_19 = OPcp2_18+qd[9]*(OMcp2_28*ROcp2_98-OMcp2_38*ROcp2_88)+qdd[9]*ROcp2_78
    OPcp2_29 = OPcp2_28+qd[9]*(-OMcp2_18*ROcp2_98+OMcp2_38*ROcp2_78)+qdd[9]*ROcp2_88
    OPcp2_39 = OPcp2_38+qd[9]*(OMcp2_18*ROcp2_88-OMcp2_28*ROcp2_78)+qdd[9]*ROcp2_98
    RLcp2_110 = q[10]*ROcp2_78
    RLcp2_210 = q[10]*ROcp2_88
    RLcp2_310 = q[10]*ROcp2_98
    POcp2_110 = POcp2_17+RLcp2_110
    POcp2_210 = POcp2_27+RLcp2_210
    POcp2_310 = POcp2_37+RLcp2_310
    ORcp2_110 = OMcp2_29*RLcp2_310-OMcp2_39*RLcp2_210
    ORcp2_210 = -OMcp2_19*RLcp2_310+OMcp2_39*RLcp2_110
    ORcp2_310 = OMcp2_19*RLcp2_210-OMcp2_29*RLcp2_110
    VIcp2_110 = ORcp2_110+VIcp2_17+qd[10]*ROcp2_78
    VIcp2_210 = ORcp2_210+VIcp2_27+qd[10]*ROcp2_88
    VIcp2_310 = ORcp2_310+VIcp2_37+qd[10]*ROcp2_98
    ACcp2_110 = ACcp2_17+(2.0)*qd[10]*(OMcp2_29*ROcp2_98-OMcp2_39*ROcp2_88)+qdd[10]*ROcp2_78+OMcp2_29*ORcp2_310-OMcp2_39*ORcp2_210+OPcp2_29*RLcp2_310-OPcp2_39*RLcp2_210
    ACcp2_210 = ACcp2_27+(2.0)*qd[10]*(-OMcp2_19*ROcp2_98+OMcp2_39*ROcp2_78)+qdd[10]*ROcp2_88-OMcp2_19*ORcp2_310+OMcp2_39*ORcp2_110-OPcp2_19*RLcp2_310+OPcp2_39*RLcp2_110
    ACcp2_310 = ACcp2_37+(2.0)*qd[10]*(OMcp2_19*ROcp2_88-OMcp2_29*ROcp2_78)+qdd[10]*ROcp2_98+OMcp2_19*ORcp2_210-OMcp2_29*ORcp2_110+OPcp2_19*RLcp2_210-OPcp2_29*RLcp2_110
    RLcp2_111 = ROcp2_78*Dz113
    RLcp2_211 = ROcp2_88*Dz113
    RLcp2_311 = ROcp2_98*Dz113
    POcp2_111 = POcp2_110+RLcp2_111
    POcp2_211 = POcp2_210+RLcp2_211
    POcp2_311 = POcp2_310+RLcp2_311
    ORcp2_111 = OMcp2_29*RLcp2_311-OMcp2_39*RLcp2_211
    ORcp2_211 = -OMcp2_19*RLcp2_311+OMcp2_39*RLcp2_111
    ORcp2_311 = OMcp2_19*RLcp2_211-OMcp2_29*RLcp2_111
    VIcp2_111 = ORcp2_111+VIcp2_110+qd[11]*ROcp2_78
    VIcp2_211 = ORcp2_211+VIcp2_210+qd[11]*ROcp2_88
    VIcp2_311 = ORcp2_311+VIcp2_310+qd[11]*ROcp2_98
    ACcp2_111 = ACcp2_110+(2.0)*qd[11]*(OMcp2_29*ROcp2_98-OMcp2_39*ROcp2_88)+qdd[11]*ROcp2_78+OMcp2_29*ORcp2_311-OMcp2_39*ORcp2_211+OPcp2_29*RLcp2_311-OPcp2_39*RLcp2_211
    ACcp2_211 = ACcp2_210+(2.0)*qd[11]*(-OMcp2_19*ROcp2_98+OMcp2_39*ROcp2_78)+qdd[11]*ROcp2_88-OMcp2_19*ORcp2_311+OMcp2_39*ORcp2_111-OPcp2_19*RLcp2_311+OPcp2_39*RLcp2_111
    ACcp2_311 = ACcp2_310+(2.0)*qd[11]*(OMcp2_19*ROcp2_88-OMcp2_29*ROcp2_78)+qdd[11]*ROcp2_98+OMcp2_19*ORcp2_211-OMcp2_29*ORcp2_111+OPcp2_19*RLcp2_211-OPcp2_29*RLcp2_111
    OMcp2_112 = OMcp2_19+qd[12]*ROcp2_19
    OMcp2_212 = OMcp2_29+qd[12]*ROcp2_29
    OMcp2_312 = OMcp2_39+qd[12]*ROcp2_39
    OPcp2_112 = OPcp2_19+qd[12]*(OMcp2_29*ROcp2_39-OMcp2_39*ROcp2_29)+qdd[12]*ROcp2_19
    OPcp2_212 = OPcp2_29+qd[12]*(-OMcp2_19*ROcp2_39+OMcp2_39*ROcp2_19)+qdd[12]*ROcp2_29
    OPcp2_312 = OPcp2_39+qd[12]*(OMcp2_19*ROcp2_29-OMcp2_29*ROcp2_19)+qdd[12]*ROcp2_39
    OMcp2_113 = OMcp2_112+qd[13]*ROcp2_412
    OMcp2_213 = OMcp2_212+qd[13]*ROcp2_512
    OMcp2_313 = OMcp2_312+qd[13]*ROcp2_612
    OPcp2_113 = OPcp2_112+qd[13]*(OMcp2_212*ROcp2_612-OMcp2_312*ROcp2_512)+qdd[13]*ROcp2_412
    OPcp2_213 = OPcp2_212+qd[13]*(-OMcp2_112*ROcp2_612+OMcp2_312*ROcp2_412)+qdd[13]*ROcp2_512
    OPcp2_313 = OPcp2_312+qd[13]*(OMcp2_112*ROcp2_512-OMcp2_212*ROcp2_412)+qdd[13]*ROcp2_612
    PxF1[1] = POcp2_111
    PxF1[2] = POcp2_211
    PxF1[3] = POcp2_311
    RxF1[1,1] = ROcp2_113
    RxF1[1,2] = ROcp2_213
    RxF1[1,3] = ROcp2_313
    RxF1[2,1] = ROcp2_412
    RxF1[2,2] = ROcp2_512
    RxF1[2,3] = ROcp2_612
    RxF1[3,1] = ROcp2_713
    RxF1[3,2] = ROcp2_813
    RxF1[3,3] = ROcp2_913
    VxF1[1] = VIcp2_111
    VxF1[2] = VIcp2_211
    VxF1[3] = VIcp2_311
    OMxF1[1] = OMcp2_113
    OMxF1[2] = OMcp2_213
    OMxF1[3] = OMcp2_313
    AxF1[1] = ACcp2_111
    AxF1[2] = ACcp2_211
    AxF1[3] = ACcp2_311
    OMPxF1[1] = OPcp2_113
    OMPxF1[2] = OPcp2_213
    OMPxF1[3] = OPcp2_313
    ROcp3_45 = -S4*C5
    ROcp3_55 = C4*C5
    ROcp3_75 = S4*S5
    ROcp3_85 = -C4*S5
    ROcp3_16 = -ROcp3_75*S6+C4*C6
    ROcp3_26 = -ROcp3_85*S6+S4*C6
    ROcp3_36 = -C5*S6
    ROcp3_76 = ROcp3_75*C6+C4*S6
    ROcp3_86 = ROcp3_85*C6+S4*S6
    ROcp3_96 = C5*C6
    ROcp3_414 = ROcp3_45*C14+ROcp3_76*S14
    ROcp3_514 = ROcp3_55*C14+ROcp3_86*S14
    ROcp3_614 = ROcp3_96*S14+C14*S5
    ROcp3_714 = -ROcp3_45*S14+ROcp3_76*C14
    ROcp3_814 = -ROcp3_55*S14+ROcp3_86*C14
    ROcp3_914 = ROcp3_96*C14-S14*S5
    ROcp3_115 = ROcp3_16*C15-ROcp3_714*S15
    ROcp3_215 = ROcp3_26*C15-ROcp3_814*S15
    ROcp3_315 = ROcp3_36*C15-ROcp3_914*S15
    ROcp3_715 = ROcp3_16*S15+ROcp3_714*C15
    ROcp3_815 = ROcp3_26*S15+ROcp3_814*C15
    ROcp3_915 = ROcp3_36*S15+ROcp3_914*C15
    ROcp3_418 = ROcp3_414*C18+ROcp3_715*S18
    ROcp3_518 = ROcp3_514*C18+ROcp3_815*S18
    ROcp3_618 = ROcp3_614*C18+ROcp3_915*S18
    ROcp3_718 = -ROcp3_414*S18+ROcp3_715*C18
    ROcp3_818 = -ROcp3_514*S18+ROcp3_815*C18
    ROcp3_918 = -ROcp3_614*S18+ROcp3_915*C18
    ROcp3_119 = ROcp3_115*C19-ROcp3_718*S19
    ROcp3_219 = ROcp3_215*C19-ROcp3_818*S19
    ROcp3_319 = ROcp3_315*C19-ROcp3_918*S19
    ROcp3_719 = ROcp3_115*S19+ROcp3_718*C19
    ROcp3_819 = ROcp3_215*S19+ROcp3_818*C19
    ROcp3_919 = ROcp3_315*S19+ROcp3_918*C19
    OMcp3_15 = qd[5]*C4
    OMcp3_25 = qd[5]*S4
    OPcp3_15 = -qd[4]*qd[5]*S4+qdd[5]*C4
    OPcp3_25 = qd[4]*qd[5]*C4+qdd[5]*S4
    OMcp3_16 = OMcp3_15+qd[6]*ROcp3_45
    OMcp3_26 = OMcp3_25+qd[6]*ROcp3_55
    OMcp3_36 = qd[4]+qd[6]*S5
    OPcp3_16 = OPcp3_15+qd[6]*(-qd[4]*ROcp3_55+OMcp3_25*S5)+qdd[6]*ROcp3_45
    OPcp3_26 = OPcp3_25+qd[6]*(qd[4]*ROcp3_45-OMcp3_15*S5)+qdd[6]*ROcp3_55
    OPcp3_36 = qdd[4]+qd[6]*(OMcp3_15*ROcp3_55-OMcp3_25*ROcp3_45)+qdd[6]*S5
    RLcp3_17 = ROcp3_16*s.dpt[1,2]+ROcp3_45*s.dpt[2,2]+ROcp3_76*s.dpt[3,2]
    RLcp3_27 = ROcp3_26*s.dpt[1,2]+ROcp3_55*s.dpt[2,2]+ROcp3_86*s.dpt[3,2]
    RLcp3_37 = ROcp3_36*s.dpt[1,2]+ROcp3_96*s.dpt[3,2]+s.dpt[2,2]*S5
    POcp3_17 = q[1]+RLcp3_17
    POcp3_27 = q[2]+RLcp3_27
    POcp3_37 = q[3]+RLcp3_37
    OMcp3_17 = OMcp3_16+qd[14]*ROcp3_16
    OMcp3_27 = OMcp3_26+qd[14]*ROcp3_26
    OMcp3_37 = OMcp3_36+qd[14]*ROcp3_36
    ORcp3_17 = OMcp3_26*RLcp3_37-OMcp3_36*RLcp3_27
    ORcp3_27 = -OMcp3_16*RLcp3_37+OMcp3_36*RLcp3_17
    ORcp3_37 = OMcp3_16*RLcp3_27-OMcp3_26*RLcp3_17
    VIcp3_17 = qd[1]+ORcp3_17
    VIcp3_27 = qd[2]+ORcp3_27
    VIcp3_37 = qd[3]+ORcp3_37
    OPcp3_17 = OPcp3_16+qd[14]*(OMcp3_26*ROcp3_36-OMcp3_36*ROcp3_26)+qdd[14]*ROcp3_16
    OPcp3_27 = OPcp3_26+qd[14]*(-OMcp3_16*ROcp3_36+OMcp3_36*ROcp3_16)+qdd[14]*ROcp3_26
    OPcp3_37 = OPcp3_36+qd[14]*(OMcp3_16*ROcp3_26-OMcp3_26*ROcp3_16)+qdd[14]*ROcp3_36
    ACcp3_17 = qdd[1]+OMcp3_26*ORcp3_37-OMcp3_36*ORcp3_27+OPcp3_26*RLcp3_37-OPcp3_36*RLcp3_27
    ACcp3_27 = qdd[2]-OMcp3_16*ORcp3_37+OMcp3_36*ORcp3_17-OPcp3_16*RLcp3_37+OPcp3_36*RLcp3_17
    ACcp3_37 = qdd[3]+OMcp3_16*ORcp3_27-OMcp3_26*ORcp3_17+OPcp3_16*RLcp3_27-OPcp3_26*RLcp3_17
    OMcp3_18 = OMcp3_17+qd[15]*ROcp3_414
    OMcp3_28 = OMcp3_27+qd[15]*ROcp3_514
    OMcp3_38 = OMcp3_37+qd[15]*ROcp3_614
    OPcp3_18 = OPcp3_17+qd[15]*(OMcp3_27*ROcp3_614-OMcp3_37*ROcp3_514)+qdd[15]*ROcp3_414
    OPcp3_28 = OPcp3_27+qd[15]*(-OMcp3_17*ROcp3_614+OMcp3_37*ROcp3_414)+qdd[15]*ROcp3_514
    OPcp3_38 = OPcp3_37+qd[15]*(OMcp3_17*ROcp3_514-OMcp3_27*ROcp3_414)+qdd[15]*ROcp3_614
    RLcp3_19 = q[16]*ROcp3_715
    RLcp3_29 = q[16]*ROcp3_815
    RLcp3_39 = q[16]*ROcp3_915
    POcp3_19 = POcp3_17+RLcp3_19
    POcp3_29 = POcp3_27+RLcp3_29
    POcp3_39 = POcp3_37+RLcp3_39
    ORcp3_19 = OMcp3_28*RLcp3_39-OMcp3_38*RLcp3_29
    ORcp3_29 = -OMcp3_18*RLcp3_39+OMcp3_38*RLcp3_19
    ORcp3_39 = OMcp3_18*RLcp3_29-OMcp3_28*RLcp3_19
    VIcp3_19 = ORcp3_19+VIcp3_17+qd[16]*ROcp3_715
    VIcp3_29 = ORcp3_29+VIcp3_27+qd[16]*ROcp3_815
    VIcp3_39 = ORcp3_39+VIcp3_37+qd[16]*ROcp3_915
    ACcp3_19 = ACcp3_17+(2.0)*qd[16]*(OMcp3_28*ROcp3_915-OMcp3_38*ROcp3_815)+qdd[16]*ROcp3_715+OMcp3_28*ORcp3_39-OMcp3_38*ORcp3_29+OPcp3_28*RLcp3_39-OPcp3_38*RLcp3_29
    ACcp3_29 = ACcp3_27+(2.0)*qd[16]*(-OMcp3_18*ROcp3_915+OMcp3_38*ROcp3_715)+qdd[16]*ROcp3_815-OMcp3_18*ORcp3_39+OMcp3_38*ORcp3_19-OPcp3_18*RLcp3_39+OPcp3_38*RLcp3_19
    ACcp3_39 = ACcp3_37+(2.0)*qd[16]*(OMcp3_18*ROcp3_815-OMcp3_28*ROcp3_715)+qdd[16]*ROcp3_915+OMcp3_18*ORcp3_29-OMcp3_28*ORcp3_19+OPcp3_18*RLcp3_29-OPcp3_28*RLcp3_19
    RLcp3_110 = ROcp3_715*Dz173
    RLcp3_210 = ROcp3_815*Dz173
    RLcp3_310 = ROcp3_915*Dz173
    POcp3_110 = POcp3_19+RLcp3_110
    POcp3_210 = POcp3_29+RLcp3_210
    POcp3_310 = POcp3_39+RLcp3_310
    ORcp3_110 = OMcp3_28*RLcp3_310-OMcp3_38*RLcp3_210
    ORcp3_210 = -OMcp3_18*RLcp3_310+OMcp3_38*RLcp3_110
    ORcp3_310 = OMcp3_18*RLcp3_210-OMcp3_28*RLcp3_110
    VIcp3_110 = ORcp3_110+VIcp3_19+qd[17]*ROcp3_715
    VIcp3_210 = ORcp3_210+VIcp3_29+qd[17]*ROcp3_815
    VIcp3_310 = ORcp3_310+VIcp3_39+qd[17]*ROcp3_915
    ACcp3_110 = ACcp3_19+(2.0)*qd[17]*(OMcp3_28*ROcp3_915-OMcp3_38*ROcp3_815)+qdd[17]*ROcp3_715+OMcp3_28*ORcp3_310-OMcp3_38*ORcp3_210+OPcp3_28*RLcp3_310-OPcp3_38*RLcp3_210
    ACcp3_210 = ACcp3_29+(2.0)*qd[17]*(-OMcp3_18*ROcp3_915+OMcp3_38*ROcp3_715)+qdd[17]*ROcp3_815-OMcp3_18*ORcp3_310+OMcp3_38*ORcp3_110-OPcp3_18*RLcp3_310+OPcp3_38*RLcp3_110
    ACcp3_310 = ACcp3_39+(2.0)*qd[17]*(OMcp3_18*ROcp3_815-OMcp3_28*ROcp3_715)+qdd[17]*ROcp3_915+OMcp3_18*ORcp3_210-OMcp3_28*ORcp3_110+OPcp3_18*RLcp3_210-OPcp3_28*RLcp3_110
    OMcp3_111 = OMcp3_18+qd[18]*ROcp3_115
    OMcp3_211 = OMcp3_28+qd[18]*ROcp3_215
    OMcp3_311 = OMcp3_38+qd[18]*ROcp3_315
    OPcp3_111 = OPcp3_18+qd[18]*(OMcp3_28*ROcp3_315-OMcp3_38*ROcp3_215)+qdd[18]*ROcp3_115
    OPcp3_211 = OPcp3_28+qd[18]*(-OMcp3_18*ROcp3_315+OMcp3_38*ROcp3_115)+qdd[18]*ROcp3_215
    OPcp3_311 = OPcp3_38+qd[18]*(OMcp3_18*ROcp3_215-OMcp3_28*ROcp3_115)+qdd[18]*ROcp3_315
    OMcp3_112 = OMcp3_111+qd[19]*ROcp3_418
    OMcp3_212 = OMcp3_211+qd[19]*ROcp3_518
    OMcp3_312 = OMcp3_311+qd[19]*ROcp3_618
    OPcp3_112 = OPcp3_111+qd[19]*(OMcp3_211*ROcp3_618-OMcp3_311*ROcp3_518)+qdd[19]*ROcp3_418
    OPcp3_212 = OPcp3_211+qd[19]*(-OMcp3_111*ROcp3_618+OMcp3_311*ROcp3_418)+qdd[19]*ROcp3_518
    OPcp3_312 = OPcp3_311+qd[19]*(OMcp3_111*ROcp3_518-OMcp3_211*ROcp3_418)+qdd[19]*ROcp3_618
    PxF2[1] = POcp3_110
    PxF2[2] = POcp3_210
    PxF2[3] = POcp3_310
    RxF2[1,1] = ROcp3_119
    RxF2[1,2] = ROcp3_219
    RxF2[1,3] = ROcp3_319
    RxF2[2,1] = ROcp3_418
    RxF2[2,2] = ROcp3_518
    RxF2[2,3] = ROcp3_618
    RxF2[3,1] = ROcp3_719
    RxF2[3,2] = ROcp3_819
    RxF2[3,3] = ROcp3_919
    VxF2[1] = VIcp3_110
    VxF2[2] = VIcp3_210
    VxF2[3] = VIcp3_310
    OMxF2[1] = OMcp3_112
    OMxF2[2] = OMcp3_212
    OMxF2[3] = OMcp3_312
    AxF2[1] = ACcp3_110
    AxF2[2] = ACcp3_210
    AxF2[3] = ACcp3_310
    OMPxF2[1] = OPcp3_112
    OMPxF2[2] = OPcp3_212
    OMPxF2[3] = OPcp3_312
    ROcp4_45 = -S4*C5
    ROcp4_55 = C4*C5
    ROcp4_75 = S4*S5
    ROcp4_85 = -C4*S5
    ROcp4_16 = -ROcp4_75*S6+C4*C6
    ROcp4_26 = -ROcp4_85*S6+S4*C6
    ROcp4_36 = -C5*S6
    ROcp4_76 = ROcp4_75*C6+C4*S6
    ROcp4_86 = ROcp4_85*C6+S4*S6
    ROcp4_96 = C5*C6
    ROcp4_420 = ROcp4_45*C20+ROcp4_76*S20
    ROcp4_520 = ROcp4_55*C20+ROcp4_86*S20
    ROcp4_620 = ROcp4_96*S20+C20*S5
    ROcp4_720 = -ROcp4_45*S20+ROcp4_76*C20
    ROcp4_820 = -ROcp4_55*S20+ROcp4_86*C20
    ROcp4_920 = ROcp4_96*C20-S20*S5
    ROcp4_121 = ROcp4_16*C21-ROcp4_720*S21
    ROcp4_221 = ROcp4_26*C21-ROcp4_820*S21
    ROcp4_321 = ROcp4_36*C21-ROcp4_920*S21
    ROcp4_721 = ROcp4_16*S21+ROcp4_720*C21
    ROcp4_821 = ROcp4_26*S21+ROcp4_820*C21
    ROcp4_921 = ROcp4_36*S21+ROcp4_920*C21
    ROcp4_122 = ROcp4_121*C22+ROcp4_420*S22
    ROcp4_222 = ROcp4_221*C22+ROcp4_520*S22
    ROcp4_322 = ROcp4_321*C22+ROcp4_620*S22
    ROcp4_422 = -ROcp4_121*S22+ROcp4_420*C22
    ROcp4_522 = -ROcp4_221*S22+ROcp4_520*C22
    ROcp4_622 = -ROcp4_321*S22+ROcp4_620*C22
    ROcp4_425 = ROcp4_422*C25+ROcp4_721*S25
    ROcp4_525 = ROcp4_522*C25+ROcp4_821*S25
    ROcp4_625 = ROcp4_622*C25+ROcp4_921*S25
    ROcp4_725 = -ROcp4_422*S25+ROcp4_721*C25
    ROcp4_825 = -ROcp4_522*S25+ROcp4_821*C25
    ROcp4_925 = -ROcp4_622*S25+ROcp4_921*C25
    ROcp4_126 = ROcp4_122*C26-ROcp4_725*S26
    ROcp4_226 = ROcp4_222*C26-ROcp4_825*S26
    ROcp4_326 = ROcp4_322*C26-ROcp4_925*S26
    ROcp4_726 = ROcp4_122*S26+ROcp4_725*C26
    ROcp4_826 = ROcp4_222*S26+ROcp4_825*C26
    ROcp4_926 = ROcp4_322*S26+ROcp4_925*C26
    OMcp4_15 = qd[5]*C4
    OMcp4_25 = qd[5]*S4
    OPcp4_15 = -qd[4]*qd[5]*S4+qdd[5]*C4
    OPcp4_25 = qd[4]*qd[5]*C4+qdd[5]*S4
    OMcp4_16 = OMcp4_15+qd[6]*ROcp4_45
    OMcp4_26 = OMcp4_25+qd[6]*ROcp4_55
    OMcp4_36 = qd[4]+qd[6]*S5
    OPcp4_16 = OPcp4_15+qd[6]*(-qd[4]*ROcp4_55+OMcp4_25*S5)+qdd[6]*ROcp4_45
    OPcp4_26 = OPcp4_25+qd[6]*(qd[4]*ROcp4_45-OMcp4_15*S5)+qdd[6]*ROcp4_55
    OPcp4_36 = qdd[4]+qd[6]*(OMcp4_15*ROcp4_55-OMcp4_25*ROcp4_45)+qdd[6]*S5
    RLcp4_17 = ROcp4_16*s.dpt[1,3]+ROcp4_45*s.dpt[2,3]+ROcp4_76*s.dpt[3,3]
    RLcp4_27 = ROcp4_26*s.dpt[1,3]+ROcp4_55*s.dpt[2,3]+ROcp4_86*s.dpt[3,3]
    RLcp4_37 = ROcp4_36*s.dpt[1,3]+ROcp4_96*s.dpt[3,3]+s.dpt[2,3]*S5
    POcp4_17 = q[1]+RLcp4_17
    POcp4_27 = q[2]+RLcp4_27
    POcp4_37 = q[3]+RLcp4_37
    OMcp4_17 = OMcp4_16+qd[20]*ROcp4_16
    OMcp4_27 = OMcp4_26+qd[20]*ROcp4_26
    OMcp4_37 = OMcp4_36+qd[20]*ROcp4_36
    ORcp4_17 = OMcp4_26*RLcp4_37-OMcp4_36*RLcp4_27
    ORcp4_27 = -OMcp4_16*RLcp4_37+OMcp4_36*RLcp4_17
    ORcp4_37 = OMcp4_16*RLcp4_27-OMcp4_26*RLcp4_17
    VIcp4_17 = qd[1]+ORcp4_17
    VIcp4_27 = qd[2]+ORcp4_27
    VIcp4_37 = qd[3]+ORcp4_37
    OPcp4_17 = OPcp4_16+qd[20]*(OMcp4_26*ROcp4_36-OMcp4_36*ROcp4_26)+qdd[20]*ROcp4_16
    OPcp4_27 = OPcp4_26+qd[20]*(-OMcp4_16*ROcp4_36+OMcp4_36*ROcp4_16)+qdd[20]*ROcp4_26
    OPcp4_37 = OPcp4_36+qd[20]*(OMcp4_16*ROcp4_26-OMcp4_26*ROcp4_16)+qdd[20]*ROcp4_36
    ACcp4_17 = qdd[1]+OMcp4_26*ORcp4_37-OMcp4_36*ORcp4_27+OPcp4_26*RLcp4_37-OPcp4_36*RLcp4_27
    ACcp4_27 = qdd[2]-OMcp4_16*ORcp4_37+OMcp4_36*ORcp4_17-OPcp4_16*RLcp4_37+OPcp4_36*RLcp4_17
    ACcp4_37 = qdd[3]+OMcp4_16*ORcp4_27-OMcp4_26*ORcp4_17+OPcp4_16*RLcp4_27-OPcp4_26*RLcp4_17
    OMcp4_18 = OMcp4_17+qd[21]*ROcp4_420
    OMcp4_28 = OMcp4_27+qd[21]*ROcp4_520
    OMcp4_38 = OMcp4_37+qd[21]*ROcp4_620
    OPcp4_18 = OPcp4_17+qd[21]*(OMcp4_27*ROcp4_620-OMcp4_37*ROcp4_520)+qdd[21]*ROcp4_420
    OPcp4_28 = OPcp4_27+qd[21]*(-OMcp4_17*ROcp4_620+OMcp4_37*ROcp4_420)+qdd[21]*ROcp4_520
    OPcp4_38 = OPcp4_37+qd[21]*(OMcp4_17*ROcp4_520-OMcp4_27*ROcp4_420)+qdd[21]*ROcp4_620
    OMcp4_19 = OMcp4_18+qd[22]*ROcp4_721
    OMcp4_29 = OMcp4_28+qd[22]*ROcp4_821
    OMcp4_39 = OMcp4_38+qd[22]*ROcp4_921
    OPcp4_19 = OPcp4_18+qd[22]*(OMcp4_28*ROcp4_921-OMcp4_38*ROcp4_821)+qdd[22]*ROcp4_721
    OPcp4_29 = OPcp4_28+qd[22]*(-OMcp4_18*ROcp4_921+OMcp4_38*ROcp4_721)+qdd[22]*ROcp4_821
    OPcp4_39 = OPcp4_38+qd[22]*(OMcp4_18*ROcp4_821-OMcp4_28*ROcp4_721)+qdd[22]*ROcp4_921
    RLcp4_110 = q[23]*ROcp4_721
    RLcp4_210 = q[23]*ROcp4_821
    RLcp4_310 = q[23]*ROcp4_921
    POcp4_110 = POcp4_17+RLcp4_110
    POcp4_210 = POcp4_27+RLcp4_210
    POcp4_310 = POcp4_37+RLcp4_310
    ORcp4_110 = OMcp4_29*RLcp4_310-OMcp4_39*RLcp4_210
    ORcp4_210 = -OMcp4_19*RLcp4_310+OMcp4_39*RLcp4_110
    ORcp4_310 = OMcp4_19*RLcp4_210-OMcp4_29*RLcp4_110
    VIcp4_110 = ORcp4_110+VIcp4_17+qd[23]*ROcp4_721
    VIcp4_210 = ORcp4_210+VIcp4_27+qd[23]*ROcp4_821
    VIcp4_310 = ORcp4_310+VIcp4_37+qd[23]*ROcp4_921
    ACcp4_110 = ACcp4_17+(2.0)*qd[23]*(OMcp4_29*ROcp4_921-OMcp4_39*ROcp4_821)+qdd[23]*ROcp4_721+OMcp4_29*ORcp4_310-OMcp4_39*ORcp4_210+OPcp4_29*RLcp4_310-OPcp4_39*RLcp4_210
    ACcp4_210 = ACcp4_27+(2.0)*qd[23]*(-OMcp4_19*ROcp4_921+OMcp4_39*ROcp4_721)+qdd[23]*ROcp4_821-OMcp4_19*ORcp4_310+OMcp4_39*ORcp4_110-OPcp4_19*RLcp4_310+OPcp4_39*RLcp4_110
    ACcp4_310 = ACcp4_37+(2.0)*qd[23]*(OMcp4_19*ROcp4_821-OMcp4_29*ROcp4_721)+qdd[23]*ROcp4_921+OMcp4_19*ORcp4_210-OMcp4_29*ORcp4_110+OPcp4_19*RLcp4_210-OPcp4_29*RLcp4_110
    RLcp4_111 = ROcp4_721*Dz243
    RLcp4_211 = ROcp4_821*Dz243
    RLcp4_311 = ROcp4_921*Dz243
    POcp4_111 = POcp4_110+RLcp4_111
    POcp4_211 = POcp4_210+RLcp4_211
    POcp4_311 = POcp4_310+RLcp4_311
    ORcp4_111 = OMcp4_29*RLcp4_311-OMcp4_39*RLcp4_211
    ORcp4_211 = -OMcp4_19*RLcp4_311+OMcp4_39*RLcp4_111
    ORcp4_311 = OMcp4_19*RLcp4_211-OMcp4_29*RLcp4_111
    VIcp4_111 = ORcp4_111+VIcp4_110+qd[24]*ROcp4_721
    VIcp4_211 = ORcp4_211+VIcp4_210+qd[24]*ROcp4_821
    VIcp4_311 = ORcp4_311+VIcp4_310+qd[24]*ROcp4_921
    ACcp4_111 = ACcp4_110+(2.0)*qd[24]*(OMcp4_29*ROcp4_921-OMcp4_39*ROcp4_821)+qdd[24]*ROcp4_721+OMcp4_29*ORcp4_311-OMcp4_39*ORcp4_211+OPcp4_29*RLcp4_311-OPcp4_39*RLcp4_211
    ACcp4_211 = ACcp4_210+(2.0)*qd[24]*(-OMcp4_19*ROcp4_921+OMcp4_39*ROcp4_721)+qdd[24]*ROcp4_821-OMcp4_19*ORcp4_311+OMcp4_39*ORcp4_111-OPcp4_19*RLcp4_311+OPcp4_39*RLcp4_111
    ACcp4_311 = ACcp4_310+(2.0)*qd[24]*(OMcp4_19*ROcp4_821-OMcp4_29*ROcp4_721)+qdd[24]*ROcp4_921+OMcp4_19*ORcp4_211-OMcp4_29*ORcp4_111+OPcp4_19*RLcp4_211-OPcp4_29*RLcp4_111
    OMcp4_112 = OMcp4_19+qd[25]*ROcp4_122
    OMcp4_212 = OMcp4_29+qd[25]*ROcp4_222
    OMcp4_312 = OMcp4_39+qd[25]*ROcp4_322
    OPcp4_112 = OPcp4_19+qd[25]*(OMcp4_29*ROcp4_322-OMcp4_39*ROcp4_222)+qdd[25]*ROcp4_122
    OPcp4_212 = OPcp4_29+qd[25]*(-OMcp4_19*ROcp4_322+OMcp4_39*ROcp4_122)+qdd[25]*ROcp4_222
    OPcp4_312 = OPcp4_39+qd[25]*(OMcp4_19*ROcp4_222-OMcp4_29*ROcp4_122)+qdd[25]*ROcp4_322
    OMcp4_113 = OMcp4_112+qd[26]*ROcp4_425
    OMcp4_213 = OMcp4_212+qd[26]*ROcp4_525
    OMcp4_313 = OMcp4_312+qd[26]*ROcp4_625
    OPcp4_113 = OPcp4_112+qd[26]*(OMcp4_212*ROcp4_625-OMcp4_312*ROcp4_525)+qdd[26]*ROcp4_425
    OPcp4_213 = OPcp4_212+qd[26]*(-OMcp4_112*ROcp4_625+OMcp4_312*ROcp4_425)+qdd[26]*ROcp4_525
    OPcp4_313 = OPcp4_312+qd[26]*(OMcp4_112*ROcp4_525-OMcp4_212*ROcp4_425)+qdd[26]*ROcp4_625
    PxF3[1] = POcp4_111
    PxF3[2] = POcp4_211
    PxF3[3] = POcp4_311
    RxF3[1,1] = ROcp4_126
    RxF3[1,2] = ROcp4_226
    RxF3[1,3] = ROcp4_326
    RxF3[2,1] = ROcp4_425
    RxF3[2,2] = ROcp4_525
    RxF3[2,3] = ROcp4_625
    RxF3[3,1] = ROcp4_726
    RxF3[3,2] = ROcp4_826
    RxF3[3,3] = ROcp4_926
    VxF3[1] = VIcp4_111
    VxF3[2] = VIcp4_211
    VxF3[3] = VIcp4_311
    OMxF3[1] = OMcp4_113
    OMxF3[2] = OMcp4_213
    OMxF3[3] = OMcp4_313
    AxF3[1] = ACcp4_111
    AxF3[2] = ACcp4_211
    AxF3[3] = ACcp4_311
    OMPxF3[1] = OPcp4_113
    OMPxF3[2] = OPcp4_213
    OMPxF3[3] = OPcp4_313
    ROcp5_45 = -S4*C5
    ROcp5_55 = C4*C5
    ROcp5_75 = S4*S5
    ROcp5_85 = -C4*S5
    ROcp5_16 = -ROcp5_75*S6+C4*C6
    ROcp5_26 = -ROcp5_85*S6+S4*C6
    ROcp5_36 = -C5*S6
    ROcp5_76 = ROcp5_75*C6+C4*S6
    ROcp5_86 = ROcp5_85*C6+S4*S6
    ROcp5_96 = C5*C6
    ROcp5_427 = ROcp5_45*C27+ROcp5_76*S27
    ROcp5_527 = ROcp5_55*C27+ROcp5_86*S27
    ROcp5_627 = ROcp5_96*S27+C27*S5
    ROcp5_727 = -ROcp5_45*S27+ROcp5_76*C27
    ROcp5_827 = -ROcp5_55*S27+ROcp5_86*C27
    ROcp5_927 = ROcp5_96*C27-S27*S5
    ROcp5_128 = ROcp5_16*C28-ROcp5_727*S28
    ROcp5_228 = ROcp5_26*C28-ROcp5_827*S28
    ROcp5_328 = ROcp5_36*C28-ROcp5_927*S28
    ROcp5_728 = ROcp5_16*S28+ROcp5_727*C28
    ROcp5_828 = ROcp5_26*S28+ROcp5_827*C28
    ROcp5_928 = ROcp5_36*S28+ROcp5_927*C28
    ROcp5_431 = ROcp5_427*C31+ROcp5_728*S31
    ROcp5_531 = ROcp5_527*C31+ROcp5_828*S31
    ROcp5_631 = ROcp5_627*C31+ROcp5_928*S31
    ROcp5_731 = -ROcp5_427*S31+ROcp5_728*C31
    ROcp5_831 = -ROcp5_527*S31+ROcp5_828*C31
    ROcp5_931 = -ROcp5_627*S31+ROcp5_928*C31
    ROcp5_132 = ROcp5_128*C32-ROcp5_731*S32
    ROcp5_232 = ROcp5_228*C32-ROcp5_831*S32
    ROcp5_332 = ROcp5_328*C32-ROcp5_931*S32
    ROcp5_732 = ROcp5_128*S32+ROcp5_731*C32
    ROcp5_832 = ROcp5_228*S32+ROcp5_831*C32
    ROcp5_932 = ROcp5_328*S32+ROcp5_931*C32
    OMcp5_15 = qd[5]*C4
    OMcp5_25 = qd[5]*S4
    OPcp5_15 = -qd[4]*qd[5]*S4+qdd[5]*C4
    OPcp5_25 = qd[4]*qd[5]*C4+qdd[5]*S4
    OMcp5_16 = OMcp5_15+qd[6]*ROcp5_45
    OMcp5_26 = OMcp5_25+qd[6]*ROcp5_55
    OMcp5_36 = qd[4]+qd[6]*S5
    OPcp5_16 = OPcp5_15+qd[6]*(-qd[4]*ROcp5_55+OMcp5_25*S5)+qdd[6]*ROcp5_45
    OPcp5_26 = OPcp5_25+qd[6]*(qd[4]*ROcp5_45-OMcp5_15*S5)+qdd[6]*ROcp5_55
    OPcp5_36 = qdd[4]+qd[6]*(OMcp5_15*ROcp5_55-OMcp5_25*ROcp5_45)+qdd[6]*S5
    RLcp5_17 = ROcp5_16*s.dpt[1,4]+ROcp5_45*s.dpt[2,4]+ROcp5_76*s.dpt[3,4]
    RLcp5_27 = ROcp5_26*s.dpt[1,4]+ROcp5_55*s.dpt[2,4]+ROcp5_86*s.dpt[3,4]
    RLcp5_37 = ROcp5_36*s.dpt[1,4]+ROcp5_96*s.dpt[3,4]+s.dpt[2,4]*S5
    POcp5_17 = q[1]+RLcp5_17
    POcp5_27 = q[2]+RLcp5_27
    POcp5_37 = q[3]+RLcp5_37
    OMcp5_17 = OMcp5_16+qd[27]*ROcp5_16
    OMcp5_27 = OMcp5_26+qd[27]*ROcp5_26
    OMcp5_37 = OMcp5_36+qd[27]*ROcp5_36
    ORcp5_17 = OMcp5_26*RLcp5_37-OMcp5_36*RLcp5_27
    ORcp5_27 = -OMcp5_16*RLcp5_37+OMcp5_36*RLcp5_17
    ORcp5_37 = OMcp5_16*RLcp5_27-OMcp5_26*RLcp5_17
    VIcp5_17 = qd[1]+ORcp5_17
    VIcp5_27 = qd[2]+ORcp5_27
    VIcp5_37 = qd[3]+ORcp5_37
    OPcp5_17 = OPcp5_16+qd[27]*(OMcp5_26*ROcp5_36-OMcp5_36*ROcp5_26)+qdd[27]*ROcp5_16
    OPcp5_27 = OPcp5_26+qd[27]*(-OMcp5_16*ROcp5_36+OMcp5_36*ROcp5_16)+qdd[27]*ROcp5_26
    OPcp5_37 = OPcp5_36+qd[27]*(OMcp5_16*ROcp5_26-OMcp5_26*ROcp5_16)+qdd[27]*ROcp5_36
    ACcp5_17 = qdd[1]+OMcp5_26*ORcp5_37-OMcp5_36*ORcp5_27+OPcp5_26*RLcp5_37-OPcp5_36*RLcp5_27
    ACcp5_27 = qdd[2]-OMcp5_16*ORcp5_37+OMcp5_36*ORcp5_17-OPcp5_16*RLcp5_37+OPcp5_36*RLcp5_17
    ACcp5_37 = qdd[3]+OMcp5_16*ORcp5_27-OMcp5_26*ORcp5_17+OPcp5_16*RLcp5_27-OPcp5_26*RLcp5_17
    OMcp5_18 = OMcp5_17+qd[28]*ROcp5_427
    OMcp5_28 = OMcp5_27+qd[28]*ROcp5_527
    OMcp5_38 = OMcp5_37+qd[28]*ROcp5_627
    OPcp5_18 = OPcp5_17+qd[28]*(OMcp5_27*ROcp5_627-OMcp5_37*ROcp5_527)+qdd[28]*ROcp5_427
    OPcp5_28 = OPcp5_27+qd[28]*(-OMcp5_17*ROcp5_627+OMcp5_37*ROcp5_427)+qdd[28]*ROcp5_527
    OPcp5_38 = OPcp5_37+qd[28]*(OMcp5_17*ROcp5_527-OMcp5_27*ROcp5_427)+qdd[28]*ROcp5_627
    RLcp5_19 = q[29]*ROcp5_728
    RLcp5_29 = q[29]*ROcp5_828
    RLcp5_39 = q[29]*ROcp5_928
    POcp5_19 = POcp5_17+RLcp5_19
    POcp5_29 = POcp5_27+RLcp5_29
    POcp5_39 = POcp5_37+RLcp5_39
    ORcp5_19 = OMcp5_28*RLcp5_39-OMcp5_38*RLcp5_29
    ORcp5_29 = -OMcp5_18*RLcp5_39+OMcp5_38*RLcp5_19
    ORcp5_39 = OMcp5_18*RLcp5_29-OMcp5_28*RLcp5_19
    VIcp5_19 = ORcp5_19+VIcp5_17+qd[29]*ROcp5_728
    VIcp5_29 = ORcp5_29+VIcp5_27+qd[29]*ROcp5_828
    VIcp5_39 = ORcp5_39+VIcp5_37+qd[29]*ROcp5_928
    ACcp5_19 = ACcp5_17+(2.0)*qd[29]*(OMcp5_28*ROcp5_928-OMcp5_38*ROcp5_828)+qdd[29]*ROcp5_728+OMcp5_28*ORcp5_39-OMcp5_38*ORcp5_29+OPcp5_28*RLcp5_39-OPcp5_38*RLcp5_29
    ACcp5_29 = ACcp5_27+(2.0)*qd[29]*(-OMcp5_18*ROcp5_928+OMcp5_38*ROcp5_728)+qdd[29]*ROcp5_828-OMcp5_18*ORcp5_39+OMcp5_38*ORcp5_19-OPcp5_18*RLcp5_39+OPcp5_38*RLcp5_19
    ACcp5_39 = ACcp5_37+(2.0)*qd[29]*(OMcp5_18*ROcp5_828-OMcp5_28*ROcp5_728)+qdd[29]*ROcp5_928+OMcp5_18*ORcp5_29-OMcp5_28*ORcp5_19+OPcp5_18*RLcp5_29-OPcp5_28*RLcp5_19
    RLcp5_110 = ROcp5_728*Dz303
    RLcp5_210 = ROcp5_828*Dz303
    RLcp5_310 = ROcp5_928*Dz303
    POcp5_110 = POcp5_19+RLcp5_110
    POcp5_210 = POcp5_29+RLcp5_210
    POcp5_310 = POcp5_39+RLcp5_310
    ORcp5_110 = OMcp5_28*RLcp5_310-OMcp5_38*RLcp5_210
    ORcp5_210 = -OMcp5_18*RLcp5_310+OMcp5_38*RLcp5_110
    ORcp5_310 = OMcp5_18*RLcp5_210-OMcp5_28*RLcp5_110
    VIcp5_110 = ORcp5_110+VIcp5_19+qd[30]*ROcp5_728
    VIcp5_210 = ORcp5_210+VIcp5_29+qd[30]*ROcp5_828
    VIcp5_310 = ORcp5_310+VIcp5_39+qd[30]*ROcp5_928
    ACcp5_110 = ACcp5_19+(2.0)*qd[30]*(OMcp5_28*ROcp5_928-OMcp5_38*ROcp5_828)+qdd[30]*ROcp5_728+OMcp5_28*ORcp5_310-OMcp5_38*ORcp5_210+OPcp5_28*RLcp5_310-OPcp5_38*RLcp5_210
    ACcp5_210 = ACcp5_29+(2.0)*qd[30]*(-OMcp5_18*ROcp5_928+OMcp5_38*ROcp5_728)+qdd[30]*ROcp5_828-OMcp5_18*ORcp5_310+OMcp5_38*ORcp5_110-OPcp5_18*RLcp5_310+OPcp5_38*RLcp5_110
    ACcp5_310 = ACcp5_39+(2.0)*qd[30]*(OMcp5_18*ROcp5_828-OMcp5_28*ROcp5_728)+qdd[30]*ROcp5_928+OMcp5_18*ORcp5_210-OMcp5_28*ORcp5_110+OPcp5_18*RLcp5_210-OPcp5_28*RLcp5_110
    OMcp5_111 = OMcp5_18+qd[31]*ROcp5_128
    OMcp5_211 = OMcp5_28+qd[31]*ROcp5_228
    OMcp5_311 = OMcp5_38+qd[31]*ROcp5_328
    OPcp5_111 = OPcp5_18+qd[31]*(OMcp5_28*ROcp5_328-OMcp5_38*ROcp5_228)+qdd[31]*ROcp5_128
    OPcp5_211 = OPcp5_28+qd[31]*(-OMcp5_18*ROcp5_328+OMcp5_38*ROcp5_128)+qdd[31]*ROcp5_228
    OPcp5_311 = OPcp5_38+qd[31]*(OMcp5_18*ROcp5_228-OMcp5_28*ROcp5_128)+qdd[31]*ROcp5_328
    OMcp5_112 = OMcp5_111+qd[32]*ROcp5_431
    OMcp5_212 = OMcp5_211+qd[32]*ROcp5_531
    OMcp5_312 = OMcp5_311+qd[32]*ROcp5_631
    OPcp5_112 = OPcp5_111+qd[32]*(OMcp5_211*ROcp5_631-OMcp5_311*ROcp5_531)+qdd[32]*ROcp5_431
    OPcp5_212 = OPcp5_211+qd[32]*(-OMcp5_111*ROcp5_631+OMcp5_311*ROcp5_431)+qdd[32]*ROcp5_531
    OPcp5_312 = OPcp5_311+qd[32]*(OMcp5_111*ROcp5_531-OMcp5_211*ROcp5_431)+qdd[32]*ROcp5_631
    PxF4[1] = POcp5_110
    PxF4[2] = POcp5_210
    PxF4[3] = POcp5_310
    RxF4[1,1] = ROcp5_132
    RxF4[1,2] = ROcp5_232
    RxF4[1,3] = ROcp5_332
    RxF4[2,1] = ROcp5_431
    RxF4[2,2] = ROcp5_531
    RxF4[2,3] = ROcp5_631
    RxF4[3,1] = ROcp5_732
    RxF4[3,2] = ROcp5_832
    RxF4[3,3] = ROcp5_932
    VxF4[1] = VIcp5_110
    VxF4[2] = VIcp5_210
    VxF4[3] = VIcp5_310
    OMxF4[1] = OMcp5_112
    OMxF4[2] = OMcp5_212
    OMxF4[3] = OMcp5_312
    AxF4[1] = ACcp5_110
    AxF4[2] = ACcp5_210
    AxF4[3] = ACcp5_310
    OMPxF4[1] = OPcp5_112
    OMPxF4[2] = OPcp5_212
    OMPxF4[3] = OPcp5_312
 
# Sensor Forces 

    SWr1 = s.user_ExtForces(PxF1,RxF1,VxF1,OMxF1,AxF1,OMPxF1,s,tsim,1)
    SWr2 = s.user_ExtForces(PxF2,RxF2,VxF2,OMxF2,AxF2,OMPxF2,s,tsim,2)
    SWr3 = s.user_ExtForces(PxF3,RxF3,VxF3,OMxF3,AxF3,OMPxF3,s,tsim,3)
    SWr4 = s.user_ExtForces(PxF4,RxF4,VxF4,OMxF4,AxF4,OMPxF4,s,tsim,4)
    xfrc12 = RxF1[1,1]*SWr1[1]+RxF1[1,2]*SWr1[2]+RxF1[1,3]*SWr1[3]
    xfrc22 = RxF1[2,1]*SWr1[1]+RxF1[2,2]*SWr1[2]+RxF1[2,3]*SWr1[3]
    xfrc32 = RxF1[3,1]*SWr1[1]+RxF1[3,2]*SWr1[2]+RxF1[3,3]*SWr1[3]
    xtrq12 = RxF1[1,1]*SWr1[4]+RxF1[1,2]*SWr1[5]+RxF1[1,3]*SWr1[6]
    xtrq22 = RxF1[2,1]*SWr1[4]+RxF1[2,2]*SWr1[5]+RxF1[2,3]*SWr1[6]
    xtrq32 = RxF1[3,1]*SWr1[4]+RxF1[3,2]*SWr1[5]+RxF1[3,3]*SWr1[6]
    trqext_1_13_1 = xtrq12-xfrc22*SWr1[9]+xfrc32*SWr1[8]
    trqext_2_13_1 = xtrq22+xfrc12*SWr1[9]-xfrc32*SWr1[7]
    trqext_3_13_1 = xtrq32-xfrc12*SWr1[8]+xfrc22*SWr1[7]
    xfrc13 = RxF2[1,1]*SWr2[1]+RxF2[1,2]*SWr2[2]+RxF2[1,3]*SWr2[3]
    xfrc23 = RxF2[2,1]*SWr2[1]+RxF2[2,2]*SWr2[2]+RxF2[2,3]*SWr2[3]
    xfrc33 = RxF2[3,1]*SWr2[1]+RxF2[3,2]*SWr2[2]+RxF2[3,3]*SWr2[3]
    xtrq13 = RxF2[1,1]*SWr2[4]+RxF2[1,2]*SWr2[5]+RxF2[1,3]*SWr2[6]
    xtrq23 = RxF2[2,1]*SWr2[4]+RxF2[2,2]*SWr2[5]+RxF2[2,3]*SWr2[6]
    xtrq33 = RxF2[3,1]*SWr2[4]+RxF2[3,2]*SWr2[5]+RxF2[3,3]*SWr2[6]
    trqext_1_19_2 = xtrq13-xfrc23*SWr2[9]+xfrc33*SWr2[8]
    trqext_2_19_2 = xtrq23+xfrc13*SWr2[9]-xfrc33*SWr2[7]
    trqext_3_19_2 = xtrq33-xfrc13*SWr2[8]+xfrc23*SWr2[7]
    xfrc14 = RxF3[1,1]*SWr3[1]+RxF3[1,2]*SWr3[2]+RxF3[1,3]*SWr3[3]
    xfrc24 = RxF3[2,1]*SWr3[1]+RxF3[2,2]*SWr3[2]+RxF3[2,3]*SWr3[3]
    xfrc34 = RxF3[3,1]*SWr3[1]+RxF3[3,2]*SWr3[2]+RxF3[3,3]*SWr3[3]
    xtrq14 = RxF3[1,1]*SWr3[4]+RxF3[1,2]*SWr3[5]+RxF3[1,3]*SWr3[6]
    xtrq24 = RxF3[2,1]*SWr3[4]+RxF3[2,2]*SWr3[5]+RxF3[2,3]*SWr3[6]
    xtrq34 = RxF3[3,1]*SWr3[4]+RxF3[3,2]*SWr3[5]+RxF3[3,3]*SWr3[6]
    trqext_1_26_3 = xtrq14-xfrc24*SWr3[9]+xfrc34*SWr3[8]
    trqext_2_26_3 = xtrq24+xfrc14*SWr3[9]-xfrc34*SWr3[7]
    trqext_3_26_3 = xtrq34-xfrc14*SWr3[8]+xfrc24*SWr3[7]
    xfrc15 = RxF4[1,1]*SWr4[1]+RxF4[1,2]*SWr4[2]+RxF4[1,3]*SWr4[3]
    xfrc25 = RxF4[2,1]*SWr4[1]+RxF4[2,2]*SWr4[2]+RxF4[2,3]*SWr4[3]
    xfrc35 = RxF4[3,1]*SWr4[1]+RxF4[3,2]*SWr4[2]+RxF4[3,3]*SWr4[3]
    xtrq15 = RxF4[1,1]*SWr4[4]+RxF4[1,2]*SWr4[5]+RxF4[1,3]*SWr4[6]
    xtrq25 = RxF4[2,1]*SWr4[4]+RxF4[2,2]*SWr4[5]+RxF4[2,3]*SWr4[6]
    xtrq35 = RxF4[3,1]*SWr4[4]+RxF4[3,2]*SWr4[5]+RxF4[3,3]*SWr4[6]
    trqext_1_32_4 = xtrq15-xfrc25*SWr4[9]+xfrc35*SWr4[8]
    trqext_2_32_4 = xtrq25+xfrc15*SWr4[9]-xfrc35*SWr4[7]
    trqext_3_32_4 = xtrq35-xfrc15*SWr4[8]+xfrc25*SWr4[7]
 
# Symbolic model output

    frc[1,13] = s.frc[1,13]+xfrc12
    frc[2,13] = s.frc[2,13]+xfrc22
    frc[3,13] = s.frc[3,13]+xfrc32
    trq[1,13] = s.trq[1,13]+trqext_1_13_1
    trq[2,13] = s.trq[2,13]+trqext_2_13_1
    trq[3,13] = s.trq[3,13]+trqext_3_13_1
    frc[1,19] = s.frc[1,19]+xfrc13
    frc[2,19] = s.frc[2,19]+xfrc23
    frc[3,19] = s.frc[3,19]+xfrc33
    trq[1,19] = s.trq[1,19]+trqext_1_19_2
    trq[2,19] = s.trq[2,19]+trqext_2_19_2
    trq[3,19] = s.trq[3,19]+trqext_3_19_2
    frc[1,26] = s.frc[1,26]+xfrc14
    frc[2,26] = s.frc[2,26]+xfrc24
    frc[3,26] = s.frc[3,26]+xfrc34
    trq[1,26] = s.trq[1,26]+trqext_1_26_3
    trq[2,26] = s.trq[2,26]+trqext_2_26_3
    trq[3,26] = s.trq[3,26]+trqext_3_26_3
    frc[1,32] = s.frc[1,32]+xfrc15
    frc[2,32] = s.frc[2,32]+xfrc25
    frc[3,32] = s.frc[3,32]+xfrc35
    trq[1,32] = s.trq[1,32]+trqext_1_32_4
    trq[2,32] = s.trq[2,32]+trqext_2_32_4
    trq[3,32] = s.trq[3,32]+trqext_3_32_4

# Number of continuation lines = 0


