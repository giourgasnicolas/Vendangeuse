#
#	MBsysTran - Release 8.1
#
#	Copyright 
#	Universite catholique de Louvain (UCLouvain) 
#	Mechatronic, Electrical Energy, and Dynamic systems (MEED Division) 
#	2, Place du Levant
#	1348 Louvain-la-Neuve 
#	Belgium 
#
#	http://www.robotran.be 
#
#	==> Generation Date: Mon May  2 16:00:06 2022
#
#	==> Project name: Vendangeuse
#
#	==> Number of joints: 31
#
#	==> Function: F19 - External Forces
#
#	==> Git hash: 220d76a94da8547597795a13c9921f0375de3fc1
#

from math import sin, cos, sqrt
from numpy import zeros

def extforces(frc, trq, s, tsim):
    q = s.q
    qd = s.qd
    qdd = s.qdd
    frc = s.frc
    trq = s.trq
    PxF1 = zeros(4)
    RxF1 = zeros((4, 4))
    VxF1 = zeros(4)
    OMxF1 = zeros(4)
    AxF1 = zeros(4)
    OMPxF1 = zeros(4)

    PxF2 = zeros(4)
    RxF2 = zeros((4, 4))
    VxF2 = zeros(4)
    OMxF2 = zeros(4)
    AxF2 = zeros(4)
    OMPxF2 = zeros(4)

    PxF3 = zeros(4)
    RxF3 = zeros((4, 4))
    VxF3 = zeros(4)
    OMxF3 = zeros(4)
    AxF3 = zeros(4)
    OMPxF3 = zeros(4)

    PxF4 = zeros(4)
    RxF4 = zeros((4, 4))
    VxF4 = zeros(4)
    OMxF4 = zeros(4)
    AxF4 = zeros(4)
    OMPxF4 = zeros(4)

 
# Trigonometric functions

    S4 = sin(q[4])
    C4 = cos(q[4])
    S5 = sin(q[5])
    C5 = cos(q[5])
    S6 = sin(q[6])
    C6 = cos(q[6])
    S7 = sin(q[7])
    C7 = cos(q[7])
    S8 = sin(q[8])
    C8 = cos(q[8])
    S9 = sin(q[9])
    C9 = cos(q[9])
    S11 = sin(q[11])
    C11 = cos(q[11])
    S12 = sin(q[12])
    C12 = cos(q[12])
    S13 = sin(q[13])
    C13 = cos(q[13])
    S14 = sin(q[14])
    C14 = cos(q[14])
    S16 = sin(q[16])
    C16 = cos(q[16])
    S17 = sin(q[17])
    C17 = cos(q[17])
    S18 = sin(q[18])
    C18 = cos(q[18])
    S19 = sin(q[19])
    C19 = cos(q[19])
    S20 = sin(q[20])
    C20 = cos(q[20])
    S22 = sin(q[22])
    C22 = cos(q[22])
    S23 = sin(q[23])
    C23 = cos(q[23])
    S24 = sin(q[24])
    C24 = cos(q[24])
    S25 = sin(q[25])
    C25 = cos(q[25])
    S27 = sin(q[27])
    C27 = cos(q[27])
    S28 = sin(q[28])
    C28 = cos(q[28])
 
# Augmented Joint Position Vectors

 
# Sensor Kinematics

    ROcp1_45 = -S4*C5
    ROcp1_55 = C4*C5
    ROcp1_75 = S4*S5
    ROcp1_85 = -C4*S5
    ROcp1_16 = -ROcp1_75*S6+C4*C6
    ROcp1_26 = -ROcp1_85*S6+S4*C6
    ROcp1_36 = -C5*S6
    ROcp1_76 = ROcp1_75*C6+C4*S6
    ROcp1_86 = ROcp1_85*C6+S4*S6
    ROcp1_96 = C5*C6
    ROcp1_47 = ROcp1_45*C7+ROcp1_76*S7
    ROcp1_57 = ROcp1_55*C7+ROcp1_86*S7
    ROcp1_67 = ROcp1_96*S7+S5*C7
    ROcp1_77 = -ROcp1_45*S7+ROcp1_76*C7
    ROcp1_87 = -ROcp1_55*S7+ROcp1_86*C7
    ROcp1_97 = ROcp1_96*C7-S5*S7
    ROcp1_18 = ROcp1_16*C8-ROcp1_77*S8
    ROcp1_28 = ROcp1_26*C8-ROcp1_87*S8
    ROcp1_38 = ROcp1_36*C8-ROcp1_97*S8
    ROcp1_78 = ROcp1_16*S8+ROcp1_77*C8
    ROcp1_88 = ROcp1_26*S8+ROcp1_87*C8
    ROcp1_98 = ROcp1_36*S8+ROcp1_97*C8
    ROcp1_19 = ROcp1_18*C9+ROcp1_47*S9
    ROcp1_29 = ROcp1_28*C9+ROcp1_57*S9
    ROcp1_39 = ROcp1_38*C9+ROcp1_67*S9
    ROcp1_49 = -ROcp1_18*S9+ROcp1_47*C9
    ROcp1_59 = -ROcp1_28*S9+ROcp1_57*C9
    ROcp1_69 = -ROcp1_38*S9+ROcp1_67*C9
    ROcp1_411 = ROcp1_49*C11+ROcp1_78*S11
    ROcp1_511 = ROcp1_59*C11+ROcp1_88*S11
    ROcp1_611 = ROcp1_69*C11+ROcp1_98*S11
    ROcp1_711 = -ROcp1_49*S11+ROcp1_78*C11
    ROcp1_811 = -ROcp1_59*S11+ROcp1_88*C11
    ROcp1_911 = -ROcp1_69*S11+ROcp1_98*C11
    ROcp1_112 = ROcp1_19*C12-ROcp1_711*S12
    ROcp1_212 = ROcp1_29*C12-ROcp1_811*S12
    ROcp1_312 = ROcp1_39*C12-ROcp1_911*S12
    ROcp1_712 = ROcp1_19*S12+ROcp1_711*C12
    ROcp1_812 = ROcp1_29*S12+ROcp1_811*C12
    ROcp1_912 = ROcp1_39*S12+ROcp1_911*C12
    OMcp1_15 = qd[5]*C4
    OMcp1_25 = qd[5]*S4
    OPcp1_15 = -qd[4]*qd[5]*S4+qdd[5]*C4
    OPcp1_25 = qd[4]*qd[5]*C4+qdd[5]*S4
    OMcp1_16 = OMcp1_15+qd[6]*ROcp1_45
    OMcp1_26 = OMcp1_25+qd[6]*ROcp1_55
    OMcp1_36 = qd[4]+qd[6]*S5
    OPcp1_16 = OPcp1_15+qd[6]*(-qd[4]*ROcp1_55+OMcp1_25*S5)+qdd[6]*ROcp1_45
    OPcp1_26 = OPcp1_25+qd[6]*(qd[4]*ROcp1_45-OMcp1_15*S5)+qdd[6]*ROcp1_55
    OPcp1_36 = qdd[4]+qd[6]*(OMcp1_15*ROcp1_55-OMcp1_25*ROcp1_45)+qdd[6]*S5
    RLcp1_17 = ROcp1_16*s.dpt[1,1]+ROcp1_45*s.dpt[2,1]+ROcp1_76*s.dpt[3,1]
    RLcp1_27 = ROcp1_26*s.dpt[1,1]+ROcp1_55*s.dpt[2,1]+ROcp1_86*s.dpt[3,1]
    RLcp1_37 = ROcp1_36*s.dpt[1,1]+ROcp1_96*s.dpt[3,1]+s.dpt[2,1]*S5
    POcp1_17 = q[1]+RLcp1_17
    POcp1_27 = q[2]+RLcp1_27
    POcp1_37 = q[3]+RLcp1_37
    OMcp1_17 = OMcp1_16+qd[7]*ROcp1_16
    OMcp1_27 = OMcp1_26+qd[7]*ROcp1_26
    OMcp1_37 = OMcp1_36+qd[7]*ROcp1_36
    ORcp1_17 = OMcp1_26*RLcp1_37-OMcp1_36*RLcp1_27
    ORcp1_27 = -OMcp1_16*RLcp1_37+OMcp1_36*RLcp1_17
    ORcp1_37 = OMcp1_16*RLcp1_27-OMcp1_26*RLcp1_17
    VIcp1_17 = qd[1]+ORcp1_17
    VIcp1_27 = qd[2]+ORcp1_27
    VIcp1_37 = qd[3]+ORcp1_37
    OPcp1_17 = OPcp1_16+qd[7]*(OMcp1_26*ROcp1_36-OMcp1_36*ROcp1_26)+qdd[7]*ROcp1_16
    OPcp1_27 = OPcp1_26+qd[7]*(-OMcp1_16*ROcp1_36+OMcp1_36*ROcp1_16)+qdd[7]*ROcp1_26
    OPcp1_37 = OPcp1_36+qd[7]*(OMcp1_16*ROcp1_26-OMcp1_26*ROcp1_16)+qdd[7]*ROcp1_36
    ACcp1_17 = qdd[1]+OMcp1_26*ORcp1_37-OMcp1_36*ORcp1_27+OPcp1_26*RLcp1_37-OPcp1_36*RLcp1_27
    ACcp1_27 = qdd[2]-OMcp1_16*ORcp1_37+OMcp1_36*ORcp1_17-OPcp1_16*RLcp1_37+OPcp1_36*RLcp1_17
    ACcp1_37 = qdd[3]+OMcp1_16*ORcp1_27-OMcp1_26*ORcp1_17+OPcp1_16*RLcp1_27-OPcp1_26*RLcp1_17
    OMcp1_18 = OMcp1_17+qd[8]*ROcp1_47
    OMcp1_28 = OMcp1_27+qd[8]*ROcp1_57
    OMcp1_38 = OMcp1_37+qd[8]*ROcp1_67
    OPcp1_18 = OPcp1_17+qd[8]*(OMcp1_27*ROcp1_67-OMcp1_37*ROcp1_57)+qdd[8]*ROcp1_47
    OPcp1_28 = OPcp1_27+qd[8]*(-OMcp1_17*ROcp1_67+OMcp1_37*ROcp1_47)+qdd[8]*ROcp1_57
    OPcp1_38 = OPcp1_37+qd[8]*(OMcp1_17*ROcp1_57-OMcp1_27*ROcp1_47)+qdd[8]*ROcp1_67
    OMcp1_19 = OMcp1_18+qd[9]*ROcp1_78
    OMcp1_29 = OMcp1_28+qd[9]*ROcp1_88
    OMcp1_39 = OMcp1_38+qd[9]*ROcp1_98
    OPcp1_19 = OPcp1_18+qd[9]*(OMcp1_28*ROcp1_98-OMcp1_38*ROcp1_88)+qdd[9]*ROcp1_78
    OPcp1_29 = OPcp1_28+qd[9]*(-OMcp1_18*ROcp1_98+OMcp1_38*ROcp1_78)+qdd[9]*ROcp1_88
    OPcp1_39 = OPcp1_38+qd[9]*(OMcp1_18*ROcp1_88-OMcp1_28*ROcp1_78)+qdd[9]*ROcp1_98
    RLcp1_110 = q[10]*ROcp1_78
    RLcp1_210 = q[10]*ROcp1_88
    RLcp1_310 = q[10]*ROcp1_98
    POcp1_110 = POcp1_17+RLcp1_110
    POcp1_210 = POcp1_27+RLcp1_210
    POcp1_310 = POcp1_37+RLcp1_310
    ORcp1_110 = OMcp1_29*RLcp1_310-OMcp1_39*RLcp1_210
    ORcp1_210 = -OMcp1_19*RLcp1_310+OMcp1_39*RLcp1_110
    ORcp1_310 = OMcp1_19*RLcp1_210-OMcp1_29*RLcp1_110
    VIcp1_110 = ORcp1_110+VIcp1_17+qd[10]*ROcp1_78
    VIcp1_210 = ORcp1_210+VIcp1_27+qd[10]*ROcp1_88
    VIcp1_310 = ORcp1_310+VIcp1_37+qd[10]*ROcp1_98
    ACcp1_110 = ACcp1_17+(2.0)*qd[10]*(OMcp1_29*ROcp1_98-OMcp1_39*ROcp1_88)+qdd[10]*ROcp1_78+OMcp1_29*ORcp1_310-OMcp1_39*ORcp1_210+OPcp1_29*RLcp1_310-OPcp1_39*RLcp1_210
    ACcp1_210 = ACcp1_27+(2.0)*qd[10]*(-OMcp1_19*ROcp1_98+OMcp1_39*ROcp1_78)+qdd[10]*ROcp1_88-OMcp1_19*ORcp1_310+OMcp1_39*ORcp1_110-OPcp1_19*RLcp1_310+OPcp1_39*RLcp1_110
    ACcp1_310 = ACcp1_37+(2.0)*qd[10]*(OMcp1_19*ROcp1_88-OMcp1_29*ROcp1_78)+qdd[10]*ROcp1_98+OMcp1_19*ORcp1_210-OMcp1_29*ORcp1_110+OPcp1_19*RLcp1_210-OPcp1_29*RLcp1_110
    RLcp1_111 = ROcp1_78*s.dpt[3,7]
    RLcp1_211 = ROcp1_88*s.dpt[3,7]
    RLcp1_311 = ROcp1_98*s.dpt[3,7]
    POcp1_111 = POcp1_110+RLcp1_111
    POcp1_211 = POcp1_210+RLcp1_211
    POcp1_311 = POcp1_310+RLcp1_311
    OMcp1_111 = OMcp1_19+qd[11]*ROcp1_19
    OMcp1_211 = OMcp1_29+qd[11]*ROcp1_29
    OMcp1_311 = OMcp1_39+qd[11]*ROcp1_39
    ORcp1_111 = OMcp1_29*RLcp1_311-OMcp1_39*RLcp1_211
    ORcp1_211 = -OMcp1_19*RLcp1_311+OMcp1_39*RLcp1_111
    ORcp1_311 = OMcp1_19*RLcp1_211-OMcp1_29*RLcp1_111
    VIcp1_111 = ORcp1_111+VIcp1_110
    VIcp1_211 = ORcp1_211+VIcp1_210
    VIcp1_311 = ORcp1_311+VIcp1_310
    OPcp1_111 = OPcp1_19+qd[11]*(OMcp1_29*ROcp1_39-OMcp1_39*ROcp1_29)+qdd[11]*ROcp1_19
    OPcp1_211 = OPcp1_29+qd[11]*(-OMcp1_19*ROcp1_39+OMcp1_39*ROcp1_19)+qdd[11]*ROcp1_29
    OPcp1_311 = OPcp1_39+qd[11]*(OMcp1_19*ROcp1_29-OMcp1_29*ROcp1_19)+qdd[11]*ROcp1_39
    ACcp1_111 = ACcp1_110+OMcp1_29*ORcp1_311-OMcp1_39*ORcp1_211+OPcp1_29*RLcp1_311-OPcp1_39*RLcp1_211
    ACcp1_211 = ACcp1_210-OMcp1_19*ORcp1_311+OMcp1_39*ORcp1_111-OPcp1_19*RLcp1_311+OPcp1_39*RLcp1_111
    ACcp1_311 = ACcp1_310+OMcp1_19*ORcp1_211-OMcp1_29*ORcp1_111+OPcp1_19*RLcp1_211-OPcp1_29*RLcp1_111
    OMcp1_112 = OMcp1_111+qd[12]*ROcp1_411
    OMcp1_212 = OMcp1_211+qd[12]*ROcp1_511
    OMcp1_312 = OMcp1_311+qd[12]*ROcp1_611
    OPcp1_112 = OPcp1_111+qd[12]*(OMcp1_211*ROcp1_611-OMcp1_311*ROcp1_511)+qdd[12]*ROcp1_411
    OPcp1_212 = OPcp1_211+qd[12]*(-OMcp1_111*ROcp1_611+OMcp1_311*ROcp1_411)+qdd[12]*ROcp1_511
    OPcp1_312 = OPcp1_311+qd[12]*(OMcp1_111*ROcp1_511-OMcp1_211*ROcp1_411)+qdd[12]*ROcp1_611
    PxF1[1] = POcp1_111
    PxF1[2] = POcp1_211
    PxF1[3] = POcp1_311
    RxF1[1,1] = ROcp1_112
    RxF1[1,2] = ROcp1_212
    RxF1[1,3] = ROcp1_312
    RxF1[2,1] = ROcp1_411
    RxF1[2,2] = ROcp1_511
    RxF1[2,3] = ROcp1_611
    RxF1[3,1] = ROcp1_712
    RxF1[3,2] = ROcp1_812
    RxF1[3,3] = ROcp1_912
    VxF1[1] = VIcp1_111
    VxF1[2] = VIcp1_211
    VxF1[3] = VIcp1_311
    OMxF1[1] = OMcp1_112
    OMxF1[2] = OMcp1_212
    OMxF1[3] = OMcp1_312
    AxF1[1] = ACcp1_111
    AxF1[2] = ACcp1_211
    AxF1[3] = ACcp1_311
    OMPxF1[1] = OPcp1_112
    OMPxF1[2] = OPcp1_212
    OMPxF1[3] = OPcp1_312
    ROcp2_45 = -S4*C5
    ROcp2_55 = C4*C5
    ROcp2_75 = S4*S5
    ROcp2_85 = -C4*S5
    ROcp2_16 = -ROcp2_75*S6+C4*C6
    ROcp2_26 = -ROcp2_85*S6+S4*C6
    ROcp2_36 = -C5*S6
    ROcp2_76 = ROcp2_75*C6+C4*S6
    ROcp2_86 = ROcp2_85*C6+S4*S6
    ROcp2_96 = C5*C6
    ROcp2_413 = ROcp2_45*C13+ROcp2_76*S13
    ROcp2_513 = ROcp2_55*C13+ROcp2_86*S13
    ROcp2_613 = ROcp2_96*S13+C13*S5
    ROcp2_713 = -ROcp2_45*S13+ROcp2_76*C13
    ROcp2_813 = -ROcp2_55*S13+ROcp2_86*C13
    ROcp2_913 = ROcp2_96*C13-S13*S5
    ROcp2_114 = ROcp2_16*C14-ROcp2_713*S14
    ROcp2_214 = ROcp2_26*C14-ROcp2_813*S14
    ROcp2_314 = ROcp2_36*C14-ROcp2_913*S14
    ROcp2_714 = ROcp2_16*S14+ROcp2_713*C14
    ROcp2_814 = ROcp2_26*S14+ROcp2_813*C14
    ROcp2_914 = ROcp2_36*S14+ROcp2_913*C14
    ROcp2_416 = ROcp2_413*C16+ROcp2_714*S16
    ROcp2_516 = ROcp2_513*C16+ROcp2_814*S16
    ROcp2_616 = ROcp2_613*C16+ROcp2_914*S16
    ROcp2_716 = -ROcp2_413*S16+ROcp2_714*C16
    ROcp2_816 = -ROcp2_513*S16+ROcp2_814*C16
    ROcp2_916 = -ROcp2_613*S16+ROcp2_914*C16
    ROcp2_117 = ROcp2_114*C17-ROcp2_716*S17
    ROcp2_217 = ROcp2_214*C17-ROcp2_816*S17
    ROcp2_317 = ROcp2_314*C17-ROcp2_916*S17
    ROcp2_717 = ROcp2_114*S17+ROcp2_716*C17
    ROcp2_817 = ROcp2_214*S17+ROcp2_816*C17
    ROcp2_917 = ROcp2_314*S17+ROcp2_916*C17
    OMcp2_15 = qd[5]*C4
    OMcp2_25 = qd[5]*S4
    OPcp2_15 = -qd[4]*qd[5]*S4+qdd[5]*C4
    OPcp2_25 = qd[4]*qd[5]*C4+qdd[5]*S4
    OMcp2_16 = OMcp2_15+qd[6]*ROcp2_45
    OMcp2_26 = OMcp2_25+qd[6]*ROcp2_55
    OMcp2_36 = qd[4]+qd[6]*S5
    OPcp2_16 = OPcp2_15+qd[6]*(-qd[4]*ROcp2_55+OMcp2_25*S5)+qdd[6]*ROcp2_45
    OPcp2_26 = OPcp2_25+qd[6]*(qd[4]*ROcp2_45-OMcp2_15*S5)+qdd[6]*ROcp2_55
    OPcp2_36 = qdd[4]+qd[6]*(OMcp2_15*ROcp2_55-OMcp2_25*ROcp2_45)+qdd[6]*S5
    RLcp2_17 = ROcp2_16*s.dpt[1,2]+ROcp2_45*s.dpt[2,2]+ROcp2_76*s.dpt[3,2]
    RLcp2_27 = ROcp2_26*s.dpt[1,2]+ROcp2_55*s.dpt[2,2]+ROcp2_86*s.dpt[3,2]
    RLcp2_37 = ROcp2_36*s.dpt[1,2]+ROcp2_96*s.dpt[3,2]+s.dpt[2,2]*S5
    POcp2_17 = q[1]+RLcp2_17
    POcp2_27 = q[2]+RLcp2_27
    POcp2_37 = q[3]+RLcp2_37
    OMcp2_17 = OMcp2_16+qd[13]*ROcp2_16
    OMcp2_27 = OMcp2_26+qd[13]*ROcp2_26
    OMcp2_37 = OMcp2_36+qd[13]*ROcp2_36
    ORcp2_17 = OMcp2_26*RLcp2_37-OMcp2_36*RLcp2_27
    ORcp2_27 = -OMcp2_16*RLcp2_37+OMcp2_36*RLcp2_17
    ORcp2_37 = OMcp2_16*RLcp2_27-OMcp2_26*RLcp2_17
    VIcp2_17 = qd[1]+ORcp2_17
    VIcp2_27 = qd[2]+ORcp2_27
    VIcp2_37 = qd[3]+ORcp2_37
    OPcp2_17 = OPcp2_16+qd[13]*(OMcp2_26*ROcp2_36-OMcp2_36*ROcp2_26)+qdd[13]*ROcp2_16
    OPcp2_27 = OPcp2_26+qd[13]*(-OMcp2_16*ROcp2_36+OMcp2_36*ROcp2_16)+qdd[13]*ROcp2_26
    OPcp2_37 = OPcp2_36+qd[13]*(OMcp2_16*ROcp2_26-OMcp2_26*ROcp2_16)+qdd[13]*ROcp2_36
    ACcp2_17 = qdd[1]+OMcp2_26*ORcp2_37-OMcp2_36*ORcp2_27+OPcp2_26*RLcp2_37-OPcp2_36*RLcp2_27
    ACcp2_27 = qdd[2]-OMcp2_16*ORcp2_37+OMcp2_36*ORcp2_17-OPcp2_16*RLcp2_37+OPcp2_36*RLcp2_17
    ACcp2_37 = qdd[3]+OMcp2_16*ORcp2_27-OMcp2_26*ORcp2_17+OPcp2_16*RLcp2_27-OPcp2_26*RLcp2_17
    OMcp2_18 = OMcp2_17+qd[14]*ROcp2_413
    OMcp2_28 = OMcp2_27+qd[14]*ROcp2_513
    OMcp2_38 = OMcp2_37+qd[14]*ROcp2_613
    OPcp2_18 = OPcp2_17+qd[14]*(OMcp2_27*ROcp2_613-OMcp2_37*ROcp2_513)+qdd[14]*ROcp2_413
    OPcp2_28 = OPcp2_27+qd[14]*(-OMcp2_17*ROcp2_613+OMcp2_37*ROcp2_413)+qdd[14]*ROcp2_513
    OPcp2_38 = OPcp2_37+qd[14]*(OMcp2_17*ROcp2_513-OMcp2_27*ROcp2_413)+qdd[14]*ROcp2_613
    RLcp2_19 = q[15]*ROcp2_714
    RLcp2_29 = q[15]*ROcp2_814
    RLcp2_39 = q[15]*ROcp2_914
    POcp2_19 = POcp2_17+RLcp2_19
    POcp2_29 = POcp2_27+RLcp2_29
    POcp2_39 = POcp2_37+RLcp2_39
    ORcp2_19 = OMcp2_28*RLcp2_39-OMcp2_38*RLcp2_29
    ORcp2_29 = -OMcp2_18*RLcp2_39+OMcp2_38*RLcp2_19
    ORcp2_39 = OMcp2_18*RLcp2_29-OMcp2_28*RLcp2_19
    VIcp2_19 = ORcp2_19+VIcp2_17+qd[15]*ROcp2_714
    VIcp2_29 = ORcp2_29+VIcp2_27+qd[15]*ROcp2_814
    VIcp2_39 = ORcp2_39+VIcp2_37+qd[15]*ROcp2_914
    ACcp2_19 = ACcp2_17+(2.0)*qd[15]*(OMcp2_28*ROcp2_914-OMcp2_38*ROcp2_814)+qdd[15]*ROcp2_714+OMcp2_28*ORcp2_39-OMcp2_38*ORcp2_29+OPcp2_28*RLcp2_39-OPcp2_38*RLcp2_29
    ACcp2_29 = ACcp2_27+(2.0)*qd[15]*(-OMcp2_18*ROcp2_914+OMcp2_38*ROcp2_714)+qdd[15]*ROcp2_814-OMcp2_18*ORcp2_39+OMcp2_38*ORcp2_19-OPcp2_18*RLcp2_39+OPcp2_38*RLcp2_19
    ACcp2_39 = ACcp2_37+(2.0)*qd[15]*(OMcp2_18*ROcp2_814-OMcp2_28*ROcp2_714)+qdd[15]*ROcp2_914+OMcp2_18*ORcp2_29-OMcp2_28*ORcp2_19+OPcp2_18*RLcp2_29-OPcp2_28*RLcp2_19
    RLcp2_110 = ROcp2_714*s.dpt[3,10]
    RLcp2_210 = ROcp2_814*s.dpt[3,10]
    RLcp2_310 = ROcp2_914*s.dpt[3,10]
    POcp2_110 = POcp2_19+RLcp2_110
    POcp2_210 = POcp2_29+RLcp2_210
    POcp2_310 = POcp2_39+RLcp2_310
    OMcp2_110 = OMcp2_18+qd[16]*ROcp2_114
    OMcp2_210 = OMcp2_28+qd[16]*ROcp2_214
    OMcp2_310 = OMcp2_38+qd[16]*ROcp2_314
    ORcp2_110 = OMcp2_28*RLcp2_310-OMcp2_38*RLcp2_210
    ORcp2_210 = -OMcp2_18*RLcp2_310+OMcp2_38*RLcp2_110
    ORcp2_310 = OMcp2_18*RLcp2_210-OMcp2_28*RLcp2_110
    VIcp2_110 = ORcp2_110+VIcp2_19
    VIcp2_210 = ORcp2_210+VIcp2_29
    VIcp2_310 = ORcp2_310+VIcp2_39
    OPcp2_110 = OPcp2_18+qd[16]*(OMcp2_28*ROcp2_314-OMcp2_38*ROcp2_214)+qdd[16]*ROcp2_114
    OPcp2_210 = OPcp2_28+qd[16]*(-OMcp2_18*ROcp2_314+OMcp2_38*ROcp2_114)+qdd[16]*ROcp2_214
    OPcp2_310 = OPcp2_38+qd[16]*(OMcp2_18*ROcp2_214-OMcp2_28*ROcp2_114)+qdd[16]*ROcp2_314
    ACcp2_110 = ACcp2_19+OMcp2_28*ORcp2_310-OMcp2_38*ORcp2_210+OPcp2_28*RLcp2_310-OPcp2_38*RLcp2_210
    ACcp2_210 = ACcp2_29-OMcp2_18*ORcp2_310+OMcp2_38*ORcp2_110-OPcp2_18*RLcp2_310+OPcp2_38*RLcp2_110
    ACcp2_310 = ACcp2_39+OMcp2_18*ORcp2_210-OMcp2_28*ORcp2_110+OPcp2_18*RLcp2_210-OPcp2_28*RLcp2_110
    OMcp2_111 = OMcp2_110+qd[17]*ROcp2_416
    OMcp2_211 = OMcp2_210+qd[17]*ROcp2_516
    OMcp2_311 = OMcp2_310+qd[17]*ROcp2_616
    OPcp2_111 = OPcp2_110+qd[17]*(OMcp2_210*ROcp2_616-OMcp2_310*ROcp2_516)+qdd[17]*ROcp2_416
    OPcp2_211 = OPcp2_210+qd[17]*(-OMcp2_110*ROcp2_616+OMcp2_310*ROcp2_416)+qdd[17]*ROcp2_516
    OPcp2_311 = OPcp2_310+qd[17]*(OMcp2_110*ROcp2_516-OMcp2_210*ROcp2_416)+qdd[17]*ROcp2_616
    PxF2[1] = POcp2_110
    PxF2[2] = POcp2_210
    PxF2[3] = POcp2_310
    RxF2[1,1] = ROcp2_117
    RxF2[1,2] = ROcp2_217
    RxF2[1,3] = ROcp2_317
    RxF2[2,1] = ROcp2_416
    RxF2[2,2] = ROcp2_516
    RxF2[2,3] = ROcp2_616
    RxF2[3,1] = ROcp2_717
    RxF2[3,2] = ROcp2_817
    RxF2[3,3] = ROcp2_917
    VxF2[1] = VIcp2_110
    VxF2[2] = VIcp2_210
    VxF2[3] = VIcp2_310
    OMxF2[1] = OMcp2_111
    OMxF2[2] = OMcp2_211
    OMxF2[3] = OMcp2_311
    AxF2[1] = ACcp2_110
    AxF2[2] = ACcp2_210
    AxF2[3] = ACcp2_310
    OMPxF2[1] = OPcp2_111
    OMPxF2[2] = OPcp2_211
    OMPxF2[3] = OPcp2_311
    ROcp3_45 = -S4*C5
    ROcp3_55 = C4*C5
    ROcp3_75 = S4*S5
    ROcp3_85 = -C4*S5
    ROcp3_16 = -ROcp3_75*S6+C4*C6
    ROcp3_26 = -ROcp3_85*S6+S4*C6
    ROcp3_36 = -C5*S6
    ROcp3_76 = ROcp3_75*C6+C4*S6
    ROcp3_86 = ROcp3_85*C6+S4*S6
    ROcp3_96 = C5*C6
    ROcp3_418 = ROcp3_45*C18+ROcp3_76*S18
    ROcp3_518 = ROcp3_55*C18+ROcp3_86*S18
    ROcp3_618 = ROcp3_96*S18+C18*S5
    ROcp3_718 = -ROcp3_45*S18+ROcp3_76*C18
    ROcp3_818 = -ROcp3_55*S18+ROcp3_86*C18
    ROcp3_918 = ROcp3_96*C18-S18*S5
    ROcp3_119 = ROcp3_16*C19-ROcp3_718*S19
    ROcp3_219 = ROcp3_26*C19-ROcp3_818*S19
    ROcp3_319 = ROcp3_36*C19-ROcp3_918*S19
    ROcp3_719 = ROcp3_16*S19+ROcp3_718*C19
    ROcp3_819 = ROcp3_26*S19+ROcp3_818*C19
    ROcp3_919 = ROcp3_36*S19+ROcp3_918*C19
    ROcp3_120 = ROcp3_119*C20+ROcp3_418*S20
    ROcp3_220 = ROcp3_219*C20+ROcp3_518*S20
    ROcp3_320 = ROcp3_319*C20+ROcp3_618*S20
    ROcp3_420 = -ROcp3_119*S20+ROcp3_418*C20
    ROcp3_520 = -ROcp3_219*S20+ROcp3_518*C20
    ROcp3_620 = -ROcp3_319*S20+ROcp3_618*C20
    ROcp3_422 = ROcp3_420*C22+ROcp3_719*S22
    ROcp3_522 = ROcp3_520*C22+ROcp3_819*S22
    ROcp3_622 = ROcp3_620*C22+ROcp3_919*S22
    ROcp3_722 = -ROcp3_420*S22+ROcp3_719*C22
    ROcp3_822 = -ROcp3_520*S22+ROcp3_819*C22
    ROcp3_922 = -ROcp3_620*S22+ROcp3_919*C22
    ROcp3_123 = ROcp3_120*C23-ROcp3_722*S23
    ROcp3_223 = ROcp3_220*C23-ROcp3_822*S23
    ROcp3_323 = ROcp3_320*C23-ROcp3_922*S23
    ROcp3_723 = ROcp3_120*S23+ROcp3_722*C23
    ROcp3_823 = ROcp3_220*S23+ROcp3_822*C23
    ROcp3_923 = ROcp3_320*S23+ROcp3_922*C23
    OMcp3_15 = qd[5]*C4
    OMcp3_25 = qd[5]*S4
    OPcp3_15 = -qd[4]*qd[5]*S4+qdd[5]*C4
    OPcp3_25 = qd[4]*qd[5]*C4+qdd[5]*S4
    OMcp3_16 = OMcp3_15+qd[6]*ROcp3_45
    OMcp3_26 = OMcp3_25+qd[6]*ROcp3_55
    OMcp3_36 = qd[4]+qd[6]*S5
    OPcp3_16 = OPcp3_15+qd[6]*(-qd[4]*ROcp3_55+OMcp3_25*S5)+qdd[6]*ROcp3_45
    OPcp3_26 = OPcp3_25+qd[6]*(qd[4]*ROcp3_45-OMcp3_15*S5)+qdd[6]*ROcp3_55
    OPcp3_36 = qdd[4]+qd[6]*(OMcp3_15*ROcp3_55-OMcp3_25*ROcp3_45)+qdd[6]*S5
    RLcp3_17 = ROcp3_16*s.dpt[1,3]+ROcp3_45*s.dpt[2,3]+ROcp3_76*s.dpt[3,3]
    RLcp3_27 = ROcp3_26*s.dpt[1,3]+ROcp3_55*s.dpt[2,3]+ROcp3_86*s.dpt[3,3]
    RLcp3_37 = ROcp3_36*s.dpt[1,3]+ROcp3_96*s.dpt[3,3]+s.dpt[2,3]*S5
    POcp3_17 = q[1]+RLcp3_17
    POcp3_27 = q[2]+RLcp3_27
    POcp3_37 = q[3]+RLcp3_37
    OMcp3_17 = OMcp3_16+qd[18]*ROcp3_16
    OMcp3_27 = OMcp3_26+qd[18]*ROcp3_26
    OMcp3_37 = OMcp3_36+qd[18]*ROcp3_36
    ORcp3_17 = OMcp3_26*RLcp3_37-OMcp3_36*RLcp3_27
    ORcp3_27 = -OMcp3_16*RLcp3_37+OMcp3_36*RLcp3_17
    ORcp3_37 = OMcp3_16*RLcp3_27-OMcp3_26*RLcp3_17
    VIcp3_17 = qd[1]+ORcp3_17
    VIcp3_27 = qd[2]+ORcp3_27
    VIcp3_37 = qd[3]+ORcp3_37
    OPcp3_17 = OPcp3_16+qd[18]*(OMcp3_26*ROcp3_36-OMcp3_36*ROcp3_26)+qdd[18]*ROcp3_16
    OPcp3_27 = OPcp3_26+qd[18]*(-OMcp3_16*ROcp3_36+OMcp3_36*ROcp3_16)+qdd[18]*ROcp3_26
    OPcp3_37 = OPcp3_36+qd[18]*(OMcp3_16*ROcp3_26-OMcp3_26*ROcp3_16)+qdd[18]*ROcp3_36
    ACcp3_17 = qdd[1]+OMcp3_26*ORcp3_37-OMcp3_36*ORcp3_27+OPcp3_26*RLcp3_37-OPcp3_36*RLcp3_27
    ACcp3_27 = qdd[2]-OMcp3_16*ORcp3_37+OMcp3_36*ORcp3_17-OPcp3_16*RLcp3_37+OPcp3_36*RLcp3_17
    ACcp3_37 = qdd[3]+OMcp3_16*ORcp3_27-OMcp3_26*ORcp3_17+OPcp3_16*RLcp3_27-OPcp3_26*RLcp3_17
    OMcp3_18 = OMcp3_17+qd[19]*ROcp3_418
    OMcp3_28 = OMcp3_27+qd[19]*ROcp3_518
    OMcp3_38 = OMcp3_37+qd[19]*ROcp3_618
    OPcp3_18 = OPcp3_17+qd[19]*(OMcp3_27*ROcp3_618-OMcp3_37*ROcp3_518)+qdd[19]*ROcp3_418
    OPcp3_28 = OPcp3_27+qd[19]*(-OMcp3_17*ROcp3_618+OMcp3_37*ROcp3_418)+qdd[19]*ROcp3_518
    OPcp3_38 = OPcp3_37+qd[19]*(OMcp3_17*ROcp3_518-OMcp3_27*ROcp3_418)+qdd[19]*ROcp3_618
    OMcp3_19 = OMcp3_18+qd[20]*ROcp3_719
    OMcp3_29 = OMcp3_28+qd[20]*ROcp3_819
    OMcp3_39 = OMcp3_38+qd[20]*ROcp3_919
    OPcp3_19 = OPcp3_18+qd[20]*(OMcp3_28*ROcp3_919-OMcp3_38*ROcp3_819)+qdd[20]*ROcp3_719
    OPcp3_29 = OPcp3_28+qd[20]*(-OMcp3_18*ROcp3_919+OMcp3_38*ROcp3_719)+qdd[20]*ROcp3_819
    OPcp3_39 = OPcp3_38+qd[20]*(OMcp3_18*ROcp3_819-OMcp3_28*ROcp3_719)+qdd[20]*ROcp3_919
    RLcp3_110 = q[21]*ROcp3_719
    RLcp3_210 = q[21]*ROcp3_819
    RLcp3_310 = q[21]*ROcp3_919
    POcp3_110 = POcp3_17+RLcp3_110
    POcp3_210 = POcp3_27+RLcp3_210
    POcp3_310 = POcp3_37+RLcp3_310
    ORcp3_110 = OMcp3_29*RLcp3_310-OMcp3_39*RLcp3_210
    ORcp3_210 = -OMcp3_19*RLcp3_310+OMcp3_39*RLcp3_110
    ORcp3_310 = OMcp3_19*RLcp3_210-OMcp3_29*RLcp3_110
    VIcp3_110 = ORcp3_110+VIcp3_17+qd[21]*ROcp3_719
    VIcp3_210 = ORcp3_210+VIcp3_27+qd[21]*ROcp3_819
    VIcp3_310 = ORcp3_310+VIcp3_37+qd[21]*ROcp3_919
    ACcp3_110 = ACcp3_17+(2.0)*qd[21]*(OMcp3_29*ROcp3_919-OMcp3_39*ROcp3_819)+qdd[21]*ROcp3_719+OMcp3_29*ORcp3_310-OMcp3_39*ORcp3_210+OPcp3_29*RLcp3_310-OPcp3_39*RLcp3_210
    ACcp3_210 = ACcp3_27+(2.0)*qd[21]*(-OMcp3_19*ROcp3_919+OMcp3_39*ROcp3_719)+qdd[21]*ROcp3_819-OMcp3_19*ORcp3_310+OMcp3_39*ORcp3_110-OPcp3_19*RLcp3_310+OPcp3_39*RLcp3_110
    ACcp3_310 = ACcp3_37+(2.0)*qd[21]*(OMcp3_19*ROcp3_819-OMcp3_29*ROcp3_719)+qdd[21]*ROcp3_919+OMcp3_19*ORcp3_210-OMcp3_29*ORcp3_110+OPcp3_19*RLcp3_210-OPcp3_29*RLcp3_110
    RLcp3_111 = ROcp3_719*s.dpt[3,12]
    RLcp3_211 = ROcp3_819*s.dpt[3,12]
    RLcp3_311 = ROcp3_919*s.dpt[3,12]
    POcp3_111 = POcp3_110+RLcp3_111
    POcp3_211 = POcp3_210+RLcp3_211
    POcp3_311 = POcp3_310+RLcp3_311
    OMcp3_111 = OMcp3_19+qd[22]*ROcp3_120
    OMcp3_211 = OMcp3_29+qd[22]*ROcp3_220
    OMcp3_311 = OMcp3_39+qd[22]*ROcp3_320
    ORcp3_111 = OMcp3_29*RLcp3_311-OMcp3_39*RLcp3_211
    ORcp3_211 = -OMcp3_19*RLcp3_311+OMcp3_39*RLcp3_111
    ORcp3_311 = OMcp3_19*RLcp3_211-OMcp3_29*RLcp3_111
    VIcp3_111 = ORcp3_111+VIcp3_110
    VIcp3_211 = ORcp3_211+VIcp3_210
    VIcp3_311 = ORcp3_311+VIcp3_310
    OPcp3_111 = OPcp3_19+qd[22]*(OMcp3_29*ROcp3_320-OMcp3_39*ROcp3_220)+qdd[22]*ROcp3_120
    OPcp3_211 = OPcp3_29+qd[22]*(-OMcp3_19*ROcp3_320+OMcp3_39*ROcp3_120)+qdd[22]*ROcp3_220
    OPcp3_311 = OPcp3_39+qd[22]*(OMcp3_19*ROcp3_220-OMcp3_29*ROcp3_120)+qdd[22]*ROcp3_320
    ACcp3_111 = ACcp3_110+OMcp3_29*ORcp3_311-OMcp3_39*ORcp3_211+OPcp3_29*RLcp3_311-OPcp3_39*RLcp3_211
    ACcp3_211 = ACcp3_210-OMcp3_19*ORcp3_311+OMcp3_39*ORcp3_111-OPcp3_19*RLcp3_311+OPcp3_39*RLcp3_111
    ACcp3_311 = ACcp3_310+OMcp3_19*ORcp3_211-OMcp3_29*ORcp3_111+OPcp3_19*RLcp3_211-OPcp3_29*RLcp3_111
    OMcp3_112 = OMcp3_111+qd[23]*ROcp3_422
    OMcp3_212 = OMcp3_211+qd[23]*ROcp3_522
    OMcp3_312 = OMcp3_311+qd[23]*ROcp3_622
    OPcp3_112 = OPcp3_111+qd[23]*(OMcp3_211*ROcp3_622-OMcp3_311*ROcp3_522)+qdd[23]*ROcp3_422
    OPcp3_212 = OPcp3_211+qd[23]*(-OMcp3_111*ROcp3_622+OMcp3_311*ROcp3_422)+qdd[23]*ROcp3_522
    OPcp3_312 = OPcp3_311+qd[23]*(OMcp3_111*ROcp3_522-OMcp3_211*ROcp3_422)+qdd[23]*ROcp3_622
    PxF3[1] = POcp3_111
    PxF3[2] = POcp3_211
    PxF3[3] = POcp3_311
    RxF3[1,1] = ROcp3_123
    RxF3[1,2] = ROcp3_223
    RxF3[1,3] = ROcp3_323
    RxF3[2,1] = ROcp3_422
    RxF3[2,2] = ROcp3_522
    RxF3[2,3] = ROcp3_622
    RxF3[3,1] = ROcp3_723
    RxF3[3,2] = ROcp3_823
    RxF3[3,3] = ROcp3_923
    VxF3[1] = VIcp3_111
    VxF3[2] = VIcp3_211
    VxF3[3] = VIcp3_311
    OMxF3[1] = OMcp3_112
    OMxF3[2] = OMcp3_212
    OMxF3[3] = OMcp3_312
    AxF3[1] = ACcp3_111
    AxF3[2] = ACcp3_211
    AxF3[3] = ACcp3_311
    OMPxF3[1] = OPcp3_112
    OMPxF3[2] = OPcp3_212
    OMPxF3[3] = OPcp3_312
    ROcp4_45 = -S4*C5
    ROcp4_55 = C4*C5
    ROcp4_75 = S4*S5
    ROcp4_85 = -C4*S5
    ROcp4_16 = -ROcp4_75*S6+C4*C6
    ROcp4_26 = -ROcp4_85*S6+S4*C6
    ROcp4_36 = -C5*S6
    ROcp4_76 = ROcp4_75*C6+C4*S6
    ROcp4_86 = ROcp4_85*C6+S4*S6
    ROcp4_96 = C5*C6
    ROcp4_424 = ROcp4_45*C24+ROcp4_76*S24
    ROcp4_524 = ROcp4_55*C24+ROcp4_86*S24
    ROcp4_624 = ROcp4_96*S24+C24*S5
    ROcp4_724 = -ROcp4_45*S24+ROcp4_76*C24
    ROcp4_824 = -ROcp4_55*S24+ROcp4_86*C24
    ROcp4_924 = ROcp4_96*C24-S24*S5
    ROcp4_125 = ROcp4_16*C25-ROcp4_724*S25
    ROcp4_225 = ROcp4_26*C25-ROcp4_824*S25
    ROcp4_325 = ROcp4_36*C25-ROcp4_924*S25
    ROcp4_725 = ROcp4_16*S25+ROcp4_724*C25
    ROcp4_825 = ROcp4_26*S25+ROcp4_824*C25
    ROcp4_925 = ROcp4_36*S25+ROcp4_924*C25
    ROcp4_427 = ROcp4_424*C27+ROcp4_725*S27
    ROcp4_527 = ROcp4_524*C27+ROcp4_825*S27
    ROcp4_627 = ROcp4_624*C27+ROcp4_925*S27
    ROcp4_727 = -ROcp4_424*S27+ROcp4_725*C27
    ROcp4_827 = -ROcp4_524*S27+ROcp4_825*C27
    ROcp4_927 = -ROcp4_624*S27+ROcp4_925*C27
    ROcp4_128 = ROcp4_125*C28-ROcp4_727*S28
    ROcp4_228 = ROcp4_225*C28-ROcp4_827*S28
    ROcp4_328 = ROcp4_325*C28-ROcp4_927*S28
    ROcp4_728 = ROcp4_125*S28+ROcp4_727*C28
    ROcp4_828 = ROcp4_225*S28+ROcp4_827*C28
    ROcp4_928 = ROcp4_325*S28+ROcp4_927*C28
    OMcp4_15 = qd[5]*C4
    OMcp4_25 = qd[5]*S4
    OPcp4_15 = -qd[4]*qd[5]*S4+qdd[5]*C4
    OPcp4_25 = qd[4]*qd[5]*C4+qdd[5]*S4
    OMcp4_16 = OMcp4_15+qd[6]*ROcp4_45
    OMcp4_26 = OMcp4_25+qd[6]*ROcp4_55
    OMcp4_36 = qd[4]+qd[6]*S5
    OPcp4_16 = OPcp4_15+qd[6]*(-qd[4]*ROcp4_55+OMcp4_25*S5)+qdd[6]*ROcp4_45
    OPcp4_26 = OPcp4_25+qd[6]*(qd[4]*ROcp4_45-OMcp4_15*S5)+qdd[6]*ROcp4_55
    OPcp4_36 = qdd[4]+qd[6]*(OMcp4_15*ROcp4_55-OMcp4_25*ROcp4_45)+qdd[6]*S5
    RLcp4_17 = ROcp4_16*s.dpt[1,4]+ROcp4_45*s.dpt[2,4]+ROcp4_76*s.dpt[3,4]
    RLcp4_27 = ROcp4_26*s.dpt[1,4]+ROcp4_55*s.dpt[2,4]+ROcp4_86*s.dpt[3,4]
    RLcp4_37 = ROcp4_36*s.dpt[1,4]+ROcp4_96*s.dpt[3,4]+s.dpt[2,4]*S5
    POcp4_17 = q[1]+RLcp4_17
    POcp4_27 = q[2]+RLcp4_27
    POcp4_37 = q[3]+RLcp4_37
    OMcp4_17 = OMcp4_16+qd[24]*ROcp4_16
    OMcp4_27 = OMcp4_26+qd[24]*ROcp4_26
    OMcp4_37 = OMcp4_36+qd[24]*ROcp4_36
    ORcp4_17 = OMcp4_26*RLcp4_37-OMcp4_36*RLcp4_27
    ORcp4_27 = -OMcp4_16*RLcp4_37+OMcp4_36*RLcp4_17
    ORcp4_37 = OMcp4_16*RLcp4_27-OMcp4_26*RLcp4_17
    VIcp4_17 = qd[1]+ORcp4_17
    VIcp4_27 = qd[2]+ORcp4_27
    VIcp4_37 = qd[3]+ORcp4_37
    OPcp4_17 = OPcp4_16+qd[24]*(OMcp4_26*ROcp4_36-OMcp4_36*ROcp4_26)+qdd[24]*ROcp4_16
    OPcp4_27 = OPcp4_26+qd[24]*(-OMcp4_16*ROcp4_36+OMcp4_36*ROcp4_16)+qdd[24]*ROcp4_26
    OPcp4_37 = OPcp4_36+qd[24]*(OMcp4_16*ROcp4_26-OMcp4_26*ROcp4_16)+qdd[24]*ROcp4_36
    ACcp4_17 = qdd[1]+OMcp4_26*ORcp4_37-OMcp4_36*ORcp4_27+OPcp4_26*RLcp4_37-OPcp4_36*RLcp4_27
    ACcp4_27 = qdd[2]-OMcp4_16*ORcp4_37+OMcp4_36*ORcp4_17-OPcp4_16*RLcp4_37+OPcp4_36*RLcp4_17
    ACcp4_37 = qdd[3]+OMcp4_16*ORcp4_27-OMcp4_26*ORcp4_17+OPcp4_16*RLcp4_27-OPcp4_26*RLcp4_17
    OMcp4_18 = OMcp4_17+qd[25]*ROcp4_424
    OMcp4_28 = OMcp4_27+qd[25]*ROcp4_524
    OMcp4_38 = OMcp4_37+qd[25]*ROcp4_624
    OPcp4_18 = OPcp4_17+qd[25]*(OMcp4_27*ROcp4_624-OMcp4_37*ROcp4_524)+qdd[25]*ROcp4_424
    OPcp4_28 = OPcp4_27+qd[25]*(-OMcp4_17*ROcp4_624+OMcp4_37*ROcp4_424)+qdd[25]*ROcp4_524
    OPcp4_38 = OPcp4_37+qd[25]*(OMcp4_17*ROcp4_524-OMcp4_27*ROcp4_424)+qdd[25]*ROcp4_624
    RLcp4_19 = q[26]*ROcp4_725
    RLcp4_29 = q[26]*ROcp4_825
    RLcp4_39 = q[26]*ROcp4_925
    POcp4_19 = POcp4_17+RLcp4_19
    POcp4_29 = POcp4_27+RLcp4_29
    POcp4_39 = POcp4_37+RLcp4_39
    ORcp4_19 = OMcp4_28*RLcp4_39-OMcp4_38*RLcp4_29
    ORcp4_29 = -OMcp4_18*RLcp4_39+OMcp4_38*RLcp4_19
    ORcp4_39 = OMcp4_18*RLcp4_29-OMcp4_28*RLcp4_19
    VIcp4_19 = ORcp4_19+VIcp4_17+qd[26]*ROcp4_725
    VIcp4_29 = ORcp4_29+VIcp4_27+qd[26]*ROcp4_825
    VIcp4_39 = ORcp4_39+VIcp4_37+qd[26]*ROcp4_925
    ACcp4_19 = ACcp4_17+(2.0)*qd[26]*(OMcp4_28*ROcp4_925-OMcp4_38*ROcp4_825)+qdd[26]*ROcp4_725+OMcp4_28*ORcp4_39-OMcp4_38*ORcp4_29+OPcp4_28*RLcp4_39-OPcp4_38*RLcp4_29
    ACcp4_29 = ACcp4_27+(2.0)*qd[26]*(-OMcp4_18*ROcp4_925+OMcp4_38*ROcp4_725)+qdd[26]*ROcp4_825-OMcp4_18*ORcp4_39+OMcp4_38*ORcp4_19-OPcp4_18*RLcp4_39+OPcp4_38*RLcp4_19
    ACcp4_39 = ACcp4_37+(2.0)*qd[26]*(OMcp4_18*ROcp4_825-OMcp4_28*ROcp4_725)+qdd[26]*ROcp4_925+OMcp4_18*ORcp4_29-OMcp4_28*ORcp4_19+OPcp4_18*RLcp4_29-OPcp4_28*RLcp4_19
    RLcp4_110 = ROcp4_725*s.dpt[3,15]
    RLcp4_210 = ROcp4_825*s.dpt[3,15]
    RLcp4_310 = ROcp4_925*s.dpt[3,15]
    POcp4_110 = POcp4_19+RLcp4_110
    POcp4_210 = POcp4_29+RLcp4_210
    POcp4_310 = POcp4_39+RLcp4_310
    OMcp4_110 = OMcp4_18+qd[27]*ROcp4_125
    OMcp4_210 = OMcp4_28+qd[27]*ROcp4_225
    OMcp4_310 = OMcp4_38+qd[27]*ROcp4_325
    ORcp4_110 = OMcp4_28*RLcp4_310-OMcp4_38*RLcp4_210
    ORcp4_210 = -OMcp4_18*RLcp4_310+OMcp4_38*RLcp4_110
    ORcp4_310 = OMcp4_18*RLcp4_210-OMcp4_28*RLcp4_110
    VIcp4_110 = ORcp4_110+VIcp4_19
    VIcp4_210 = ORcp4_210+VIcp4_29
    VIcp4_310 = ORcp4_310+VIcp4_39
    OPcp4_110 = OPcp4_18+qd[27]*(OMcp4_28*ROcp4_325-OMcp4_38*ROcp4_225)+qdd[27]*ROcp4_125
    OPcp4_210 = OPcp4_28+qd[27]*(-OMcp4_18*ROcp4_325+OMcp4_38*ROcp4_125)+qdd[27]*ROcp4_225
    OPcp4_310 = OPcp4_38+qd[27]*(OMcp4_18*ROcp4_225-OMcp4_28*ROcp4_125)+qdd[27]*ROcp4_325
    ACcp4_110 = ACcp4_19+OMcp4_28*ORcp4_310-OMcp4_38*ORcp4_210+OPcp4_28*RLcp4_310-OPcp4_38*RLcp4_210
    ACcp4_210 = ACcp4_29-OMcp4_18*ORcp4_310+OMcp4_38*ORcp4_110-OPcp4_18*RLcp4_310+OPcp4_38*RLcp4_110
    ACcp4_310 = ACcp4_39+OMcp4_18*ORcp4_210-OMcp4_28*ORcp4_110+OPcp4_18*RLcp4_210-OPcp4_28*RLcp4_110
    OMcp4_111 = OMcp4_110+qd[28]*ROcp4_427
    OMcp4_211 = OMcp4_210+qd[28]*ROcp4_527
    OMcp4_311 = OMcp4_310+qd[28]*ROcp4_627
    OPcp4_111 = OPcp4_110+qd[28]*(OMcp4_210*ROcp4_627-OMcp4_310*ROcp4_527)+qdd[28]*ROcp4_427
    OPcp4_211 = OPcp4_210+qd[28]*(-OMcp4_110*ROcp4_627+OMcp4_310*ROcp4_427)+qdd[28]*ROcp4_527
    OPcp4_311 = OPcp4_310+qd[28]*(OMcp4_110*ROcp4_527-OMcp4_210*ROcp4_427)+qdd[28]*ROcp4_627
    PxF4[1] = POcp4_110
    PxF4[2] = POcp4_210
    PxF4[3] = POcp4_310
    RxF4[1,1] = ROcp4_128
    RxF4[1,2] = ROcp4_228
    RxF4[1,3] = ROcp4_328
    RxF4[2,1] = ROcp4_427
    RxF4[2,2] = ROcp4_527
    RxF4[2,3] = ROcp4_627
    RxF4[3,1] = ROcp4_728
    RxF4[3,2] = ROcp4_828
    RxF4[3,3] = ROcp4_928
    VxF4[1] = VIcp4_110
    VxF4[2] = VIcp4_210
    VxF4[3] = VIcp4_310
    OMxF4[1] = OMcp4_111
    OMxF4[2] = OMcp4_211
    OMxF4[3] = OMcp4_311
    AxF4[1] = ACcp4_110
    AxF4[2] = ACcp4_210
    AxF4[3] = ACcp4_310
    OMPxF4[1] = OPcp4_111
    OMPxF4[2] = OPcp4_211
    OMPxF4[3] = OPcp4_311
 
# Sensor Forces 

    SWr1 = s.user_ExtForces(PxF1,RxF1,VxF1,OMxF1,AxF1,OMPxF1,s,tsim,1)
    SWr2 = s.user_ExtForces(PxF2,RxF2,VxF2,OMxF2,AxF2,OMPxF2,s,tsim,2)
    SWr3 = s.user_ExtForces(PxF3,RxF3,VxF3,OMxF3,AxF3,OMPxF3,s,tsim,3)
    SWr4 = s.user_ExtForces(PxF4,RxF4,VxF4,OMxF4,AxF4,OMPxF4,s,tsim,4)
    xfrc11 = RxF1[1,1]*SWr1[1]+RxF1[1,2]*SWr1[2]+RxF1[1,3]*SWr1[3]
    xfrc21 = RxF1[2,1]*SWr1[1]+RxF1[2,2]*SWr1[2]+RxF1[2,3]*SWr1[3]
    xfrc31 = RxF1[3,1]*SWr1[1]+RxF1[3,2]*SWr1[2]+RxF1[3,3]*SWr1[3]
    xtrq11 = RxF1[1,1]*SWr1[4]+RxF1[1,2]*SWr1[5]+RxF1[1,3]*SWr1[6]
    xtrq21 = RxF1[2,1]*SWr1[4]+RxF1[2,2]*SWr1[5]+RxF1[2,3]*SWr1[6]
    xtrq31 = RxF1[3,1]*SWr1[4]+RxF1[3,2]*SWr1[5]+RxF1[3,3]*SWr1[6]
    trqext_1_12_0 = xtrq11-xfrc21*SWr1[9]+xfrc31*SWr1[8]
    trqext_2_12_0 = xtrq21+xfrc11*SWr1[9]-xfrc31*SWr1[7]
    trqext_3_12_0 = xtrq31-xfrc11*SWr1[8]+xfrc21*SWr1[7]
    xfrc12 = RxF2[1,1]*SWr2[1]+RxF2[1,2]*SWr2[2]+RxF2[1,3]*SWr2[3]
    xfrc22 = RxF2[2,1]*SWr2[1]+RxF2[2,2]*SWr2[2]+RxF2[2,3]*SWr2[3]
    xfrc32 = RxF2[3,1]*SWr2[1]+RxF2[3,2]*SWr2[2]+RxF2[3,3]*SWr2[3]
    xtrq12 = RxF2[1,1]*SWr2[4]+RxF2[1,2]*SWr2[5]+RxF2[1,3]*SWr2[6]
    xtrq22 = RxF2[2,1]*SWr2[4]+RxF2[2,2]*SWr2[5]+RxF2[2,3]*SWr2[6]
    xtrq32 = RxF2[3,1]*SWr2[4]+RxF2[3,2]*SWr2[5]+RxF2[3,3]*SWr2[6]
    trqext_1_17_1 = xtrq12-xfrc22*SWr2[9]+xfrc32*SWr2[8]
    trqext_2_17_1 = xtrq22+xfrc12*SWr2[9]-xfrc32*SWr2[7]
    trqext_3_17_1 = xtrq32-xfrc12*SWr2[8]+xfrc22*SWr2[7]
    xfrc13 = RxF3[1,1]*SWr3[1]+RxF3[1,2]*SWr3[2]+RxF3[1,3]*SWr3[3]
    xfrc23 = RxF3[2,1]*SWr3[1]+RxF3[2,2]*SWr3[2]+RxF3[2,3]*SWr3[3]
    xfrc33 = RxF3[3,1]*SWr3[1]+RxF3[3,2]*SWr3[2]+RxF3[3,3]*SWr3[3]
    xtrq13 = RxF3[1,1]*SWr3[4]+RxF3[1,2]*SWr3[5]+RxF3[1,3]*SWr3[6]
    xtrq23 = RxF3[2,1]*SWr3[4]+RxF3[2,2]*SWr3[5]+RxF3[2,3]*SWr3[6]
    xtrq33 = RxF3[3,1]*SWr3[4]+RxF3[3,2]*SWr3[5]+RxF3[3,3]*SWr3[6]
    trqext_1_23_2 = xtrq13-xfrc23*SWr3[9]+xfrc33*SWr3[8]
    trqext_2_23_2 = xtrq23+xfrc13*SWr3[9]-xfrc33*SWr3[7]
    trqext_3_23_2 = xtrq33-xfrc13*SWr3[8]+xfrc23*SWr3[7]
    xfrc14 = RxF4[1,1]*SWr4[1]+RxF4[1,2]*SWr4[2]+RxF4[1,3]*SWr4[3]
    xfrc24 = RxF4[2,1]*SWr4[1]+RxF4[2,2]*SWr4[2]+RxF4[2,3]*SWr4[3]
    xfrc34 = RxF4[3,1]*SWr4[1]+RxF4[3,2]*SWr4[2]+RxF4[3,3]*SWr4[3]
    xtrq14 = RxF4[1,1]*SWr4[4]+RxF4[1,2]*SWr4[5]+RxF4[1,3]*SWr4[6]
    xtrq24 = RxF4[2,1]*SWr4[4]+RxF4[2,2]*SWr4[5]+RxF4[2,3]*SWr4[6]
    xtrq34 = RxF4[3,1]*SWr4[4]+RxF4[3,2]*SWr4[5]+RxF4[3,3]*SWr4[6]
    trqext_1_28_3 = xtrq14-xfrc24*SWr4[9]+xfrc34*SWr4[8]
    trqext_2_28_3 = xtrq24+xfrc14*SWr4[9]-xfrc34*SWr4[7]
    trqext_3_28_3 = xtrq34-xfrc14*SWr4[8]+xfrc24*SWr4[7]
 
# Symbolic model output

    frc[1,12] = s.frc[1,12]+xfrc11
    frc[2,12] = s.frc[2,12]+xfrc21
    frc[3,12] = s.frc[3,12]+xfrc31
    trq[1,12] = s.trq[1,12]+trqext_1_12_0
    trq[2,12] = s.trq[2,12]+trqext_2_12_0
    trq[3,12] = s.trq[3,12]+trqext_3_12_0
    frc[1,17] = s.frc[1,17]+xfrc12
    frc[2,17] = s.frc[2,17]+xfrc22
    frc[3,17] = s.frc[3,17]+xfrc32
    trq[1,17] = s.trq[1,17]+trqext_1_17_1
    trq[2,17] = s.trq[2,17]+trqext_2_17_1
    trq[3,17] = s.trq[3,17]+trqext_3_17_1
    frc[1,23] = s.frc[1,23]+xfrc13
    frc[2,23] = s.frc[2,23]+xfrc23
    frc[3,23] = s.frc[3,23]+xfrc33
    trq[1,23] = s.trq[1,23]+trqext_1_23_2
    trq[2,23] = s.trq[2,23]+trqext_2_23_2
    trq[3,23] = s.trq[3,23]+trqext_3_23_2
    frc[1,28] = s.frc[1,28]+xfrc14
    frc[2,28] = s.frc[2,28]+xfrc24
    frc[3,28] = s.frc[3,28]+xfrc34
    trq[1,28] = s.trq[1,28]+trqext_1_28_3
    trq[2,28] = s.trq[2,28]+trqext_2_28_3
    trq[3,28] = s.trq[3,28]+trqext_3_28_3

# Number of continuation lines = 0


